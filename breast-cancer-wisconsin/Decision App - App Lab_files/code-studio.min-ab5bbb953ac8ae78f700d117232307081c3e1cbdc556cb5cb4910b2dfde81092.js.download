webpackJsonp([11],{1047:function(e,t,n){"use strict";function r(e,t){var n=(t&g)>>>T;return Math.pow(2,e)&n}Object.defineProperty(t,"__esModule",{value:!0}),t.squareHasItemClass=r;var o=t.SpriteSpeed={VERY_SLOW:2,SLOW:3,LITTLE_SLOW:4,NORMAL:5,LITTLE_FAST:6,FAST:8,VERY_FAST:12},i=(t.SpriteSize={VERY_SMALL:.5,SMALL:.75,NORMAL:1,LARGE:1.5,VERY_LARGE:2},t.Direction={NONE:0,NORTH:1,EAST:2,SOUTH:4,WEST:8,NORTHEAST:3,SOUTHEAST:6,SOUTHWEST:12,NORTHWEST:9}),a=(t.turnLeft90=function(e){return e>>1||i.WEST},t.turnRight90=function(e){return e<<1&15||i.NORTH},i),s=t.ClockwiseDirectionsFromNorth=[a.NORTH,a.NORTHEAST,a.EAST,a.SOUTHEAST,a.SOUTH,a.SOUTHWEST,a.WEST,a.NORTHWEST],l=(t.CardinalDirections=[a.NORTH,a.SOUTH,a.EAST,a.WEST],t.getClosestDirection=function(e,t){var n=Math.atan2(e,-t),r=Math.PI/4,o=(Math.round(n/r)+8)%8;return s[o]},t.frameDirTable={});l[a.SOUTHEAST]=0,l[a.EAST]=1,l[a.NORTHEAST]=2,l[a.NORTH]=3,l[a.NORTHWEST]=4,l[a.WEST]=5,l[a.SOUTHWEST]=6;var u=t.frameDirTableWalking={};u[a.NONE]=0,u[a.SOUTH]=0,u[a.SOUTHEAST]=1,u[a.EAST]=2,u[a.NORTHEAST]=3,u[a.NORTH]=4,u[a.NORTHWEST]=5,u[a.WEST]=6,u[a.SOUTHWEST]=7;var p=t.frameDirTableWalkingWithIdleClockwise={};p[a.NONE]=8,p[a.SOUTH]=0,p[a.SOUTHEAST]=1,p[a.EAST]=2,p[a.NORTHEAST]=3,p[a.NORTH]=4,p[a.NORTHWEST]=5,p[a.WEST]=6,p[a.SOUTHWEST]=7;var c=t.frameDirTableWalkingWithIdleCounterclockwise={};c[a.NONE]=8,c[a.SOUTH]=0,c[a.SOUTHEAST]=7,c[a.EAST]=6,c[a.NORTHEAST]=5,c[a.NORTH]=4,c[a.NORTHWEST]=3,c[a.WEST]=2,c[a.SOUTHWEST]=1;var d=t.UNIT_VECTOR={};d[a.NONE]={x:0,y:0},d[a.NORTH]={x:0,y:-1},d[a.EAST]={x:1,y:0},d[a.SOUTH]={x:0,y:1},d[a.WEST]={x:-1,y:0},d[a.NORTHEAST]={x:1,y:-1},d[a.SOUTHEAST]={x:1,y:1},d[a.SOUTHWEST]={x:-1,y:1},d[a.NORTHWEST]={x:-1,y:-1},a.getUnitVector=function(e){return d[e]};var f=(t.Position={OUTTOPOUTLEFT:1,OUTTOPLEFT:2,OUTTOPCENTER:3,OUTTOPRIGHT:4,OUTTOPOUTRIGHT:5,TOPOUTLEFT:6,TOPLEFT:7,TOPCENTER:8,TOPRIGHT:9,TOPOUTRIGHT:10,MIDDLEOUTLEFT:11,MIDDLELEFT:12,MIDDLECENTER:13,MIDDLERIGHT:14,MIDDLEOUTRIGHT:15,BOTTOMOUTLEFT:16,BOTTOMLEFT:17,BOTTOMCENTER:18,BOTTOMRIGHT:19,BOTTOMOUTRIGHT:20,OUTBOTTOMOUTLEFT:21,OUTBOTTOMLEFT:22,OUTBOTTOMCENTER:23,OUTBOTTOMRIGHT:24,OUTBOTTOMOUTRIGHT:25},t.NextTurn={});f[a.NORTH]={},f[a.NORTH][a.NORTH]=a.NORTH,f[a.NORTH][a.EAST]=a.NORTHEAST,f[a.NORTH][a.SOUTH]=a.NORTHEAST,f[a.NORTH][a.NONE]=a.NORTHEAST,f[a.NORTH][a.WEST]=a.NORTHWEST,f[a.NORTH][a.NORTHEAST]=a.NORTHEAST,f[a.NORTH][a.SOUTHEAST]=a.NORTHEAST,f[a.NORTH][a.SOUTHWEST]=a.NORTHWEST,f[a.NORTH][a.NORTHWEST]=a.NORTHWEST,f[a.EAST]={},f[a.EAST][a.NORTH]=a.NORTHEAST,f[a.EAST][a.EAST]=a.EAST,f[a.EAST][a.SOUTH]=a.SOUTHEAST,f[a.EAST][a.NONE]=a.SOUTHEAST,f[a.EAST][a.WEST]=a.SOUTHEAST,f[a.EAST][a.NORTHEAST]=a.NORTHEAST,f[a.EAST][a.SOUTHEAST]=a.SOUTHEAST,f[a.EAST][a.SOUTHWEST]=a.SOUTHEAST,f[a.EAST][a.NORTHWEST]=a.NORTHEAST,f[a.SOUTH]={},f[a.SOUTH][a.NORTH]=a.SOUTHEAST,f[a.SOUTH][a.EAST]=a.SOUTHEAST,f[a.SOUTH][a.SOUTH]=a.SOUTH,f[a.SOUTH][a.NONE]=a.NONE,f[a.SOUTH][a.WEST]=a.SOUTHWEST,f[a.SOUTH][a.NORTHEAST]=a.SOUTHEAST,f[a.SOUTH][a.SOUTHEAST]=a.SOUTHEAST,f[a.SOUTH][a.SOUTHWEST]=a.SOUTHWEST,f[a.SOUTH][a.NORTHWEST]=a.SOUTHWEST,f[a.WEST]={},f[a.WEST][a.NORTH]=a.NORTHWEST,f[a.WEST][a.EAST]=a.SOUTHWEST,f[a.WEST][a.SOUTH]=a.SOUTHWEST,f[a.WEST][a.NONE]=a.SOUTHWEST,f[a.WEST][a.WEST]=a.WEST,f[a.WEST][a.NORTHEAST]=a.NORTHWEST,f[a.WEST][a.SOUTHEAST]=a.SOUTHWEST,f[a.WEST][a.SOUTHWEST]=a.SOUTHWEST,f[a.WEST][a.NORTHWEST]=a.NORTHWEST,f[a.NORTHEAST]={},f[a.NORTHEAST][a.NORTH]=a.NORTH,f[a.NORTHEAST][a.EAST]=a.EAST,f[a.NORTHEAST][a.SOUTH]=a.EAST,f[a.NORTHEAST][a.NONE]=a.EAST,f[a.NORTHEAST][a.WEST]=a.NORTH,f[a.NORTHEAST][a.NORTHEAST]=a.NORTHEAST,f[a.NORTHEAST][a.SOUTHEAST]=a.EAST,f[a.NORTHEAST][a.SOUTHWEST]=a.EAST,f[a.NORTHEAST][a.NORTHWEST]=a.NORTH,f[a.SOUTHEAST]={},f[a.SOUTHEAST][a.NORTH]=a.EAST,f[a.SOUTHEAST][a.EAST]=a.EAST,f[a.SOUTHEAST][a.SOUTH]=a.SOUTH,f[a.SOUTHEAST][a.NONE]=a.SOUTH,f[a.SOUTHEAST][a.WEST]=a.SOUTH,f[a.SOUTHEAST][a.NORTHEAST]=a.EAST,f[a.SOUTHEAST][a.SOUTHEAST]=a.SOUTHEAST,f[a.SOUTHEAST][a.SOUTHWEST]=a.SOUTH,f[a.SOUTHEAST][a.NORTHWEST]=a.SOUTH,f[a.SOUTHWEST]={},f[a.SOUTHWEST][a.NORTH]=a.WEST,f[a.SOUTHWEST][a.EAST]=a.SOUTH,f[a.SOUTHWEST][a.SOUTH]=a.SOUTH,f[a.SOUTHWEST][a.NONE]=a.SOUTH,f[a.SOUTHWEST][a.WEST]=a.WEST,f[a.SOUTHWEST][a.NORTHEAST]=a.SOUTH,f[a.SOUTHWEST][a.SOUTHEAST]=a.SOUTH,f[a.SOUTHWEST][a.SOUTHWEST]=a.SOUTHWEST,f[a.SOUTHWEST][a.NORTHWEST]=a.WEST,f[a.NORTHWEST]={},f[a.NORTHWEST][a.NORTH]=a.NORTH,f[a.NORTHWEST][a.EAST]=a.NORTH,f[a.NORTHWEST][a.SOUTH]=a.WEST,f[a.NORTHWEST][a.NONE]=a.WEST,f[a.NORTHWEST][a.WEST]=a.WEST,f[a.NORTHWEST][a.NORTHEAST]=a.NORTH,f[a.NORTHWEST][a.SOUTHEAST]=a.WEST,f[a.NORTHWEST][a.SOUTHWEST]=a.WEST,f[a.NORTHWEST][a.NORTHWEST]=a.NORTHWEST,f[a.NONE]={},f[a.NONE][a.NORTH]=a.SOUTHEAST,f[a.NONE][a.EAST]=a.SOUTHEAST,f[a.NONE][a.SOUTH]=a.SOUTH,f[a.NONE][a.NONE]=a.NONE,f[a.NONE][a.WEST]=a.SOUTHWEST,f[a.NONE][a.NORTHEAST]=a.SOUTHEAST,f[a.NONE][a.SOUTHEAST]=a.SOUTHEAST,f[a.NONE][a.SOUTHWEST]=a.SOUTHWEST,f[a.NONE][a.NORTHWEST]=a.SOUTHWEST;var h=(t.Emotions={NORMAL:0,HAPPY:1,ANGRY:2,SAD:3},t.FINISH_COLLIDE_DISTANCE_SCALING=.75,t.SPRITE_COLLIDE_DISTANCE_SCALING=.9,t.DEFAULT_SPRITE_SPEED=o.NORMAL,t.DEFAULT_SPRITE_SIZE=1,t.DEFAULT_SPRITE_ANIMATION_FRAME_DURATION=6,t.DEFAULT_PROJECTILE_SPEED=o.SLOW,t.DEFAULT_PROJECTILE_ANIMATION_FRAME_DURATION=1.5,t.DEFAULT_ITEM_SPEED=o.SLOW,t.DEFAULT_ITEM_ANIMATION_FRAME_DURATION=1.5,t.SquareType={OPEN:0,SPRITEFINISH:1,NOT_USED_2:2,WALL:4,NOT_USED_8:8,SPRITESTART:16,ITEM_CLASS_0:32,ITEM_CLASS_1:64,ITEM_CLASS_2:128,ITEM_CLASS_3:256,ITEM_CLASS_4:512,ITEM_CLASS_5:1024,ITEM_CLASS_6:2048,ITEM_CLASS_7:4096,NOT_USED_8K:8192,NOT_USED_16K:16384,NOT_USED_32K:32768}),g=t.SquareItemClassMask=h.ITEM_CLASS_0|h.ITEM_CLASS_1|h.ITEM_CLASS_2|h.ITEM_CLASS_3|h.ITEM_CLASS_4|h.ITEM_CLASS_5|h.ITEM_CLASS_6|h.ITEM_CLASS_7,T=t.SquareItemClassShift=5,m=(t.WallType={NORMAL_SIZE:0,DOUBLE_SIZE:1,JUMBO_SIZE:2},t.WallTypeMask=251658240),y=t.WallCoordRowMask=15728640,v=t.WallCoordColMask=983040,S=t.WallCoordsMask=m|y|v,O=t.WallCoordsShift=16;t.WallCoordColShift=O,t.WallCoordRowShift=O+4,t.WallTypeShift=O+8,t.WallCoordMax=16,t.WallRandomCoordMax=2,t.WallAnyMask=S|h.WALL,t.floatingScoreChangeOpacity=-.025,t.floatingScoreChangeY=-1,t.RANDOM_VALUE="random",t.HIDDEN_VALUE='"hidden"',t.CLICK_VALUE='"click"',t.VISIBLE_VALUE='"visible"',t.EMPTY_QUOTES='""',t.IDLE_TICKS_BEFORE_FACE_SOUTH=4,t.DEFAULT_ANIMATION_RATE=20,t.GOAL_FADE_TIME=200,t.ITEM_FADE_TIME=200,t.DEFAULT_ACTOR_FADE_TIME=1e3,t.TOUCH_HAZARD_EFFECT_TIME=1500,t.SHAKE_DEFAULT_DURATION=1e3,t.SHAKE_DEFAULT_CYCLES=6,t.SHAKE_DEFAULT_DISTANCE=5,t.MAX_NUM_CLOUDS=2,t.CLOUD_SIZE=300,t.CLOUD_OPACITY=.7,t.SOUND_THROTTLE_TIME=200,t.TOUCH_OBSTACLE_THROTTLE_TIME=330,t.BEHAVIOR_CHASE="chase",t.BEHAVIOR_FLEE="flee",t.BEHAVIOR_STOP="none",t.BEHAVIOR_WANDER="roam",t.BEHAVIOR_WATCH_ACTOR="watchActor",t.BEHAVIOR_GRID_ALIGNED="grid",t.CAPTURE_TICK_COUNT=20},1551:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(1203),p=u.tiles.SquareType,c=function(e){function t(n){r(this,t);var i=o(this,e.call(this,n));return i.handleChange=i.handleChange.bind(i),i}return i(t,e),t.prototype.handleChange=function(){var e=new FormData(this.form),t=Array.from(e).reduce(function(e,t){var n=a(t,2),r=n[0],o=n[1];return o="undefined"===o?void 0:isNaN(o)?"":Number(o),r in e?Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]:e[r]=o,e},{});this.props.onUpdate(t)},t.prototype.getSelectFieldNames=function(){return["tileType"]},t.prototype.getSanitizedValues=function(){var e=this.props.cell.serialize();return this.getSelectFieldNames().forEach(function(t){void 0===e[t]&&(e[t]="undefined")}),e},t.prototype.renderTileTypes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;return l.default.createElement("div",null,l.default.createElement("label",{htmlFor:"tileType"},"Tile Type (required):"),l.default.createElement("select",{name:"tileType",value:e.tileType,onChange:this.handleChange},Object.keys(t).map(function(e){return l.default.createElement("option",{key:e,value:t[e]},e.toLowerCase())})))},t.prototype.renderFields=function(e){return l.default.createElement("div",null,this.renderTileTypes(e),l.default.createElement("label",{htmlFor:"value"},"Value:"),l.default.createElement("input",{type:"number",name:"value",value:e.value,onChange:this.handleChange}),l.default.createElement("label",{htmlFor:"range"},"Range (defaults to value):"),l.default.createElement("input",{type:"number",name:"range",value:e.range,disabled:"undefined"===e.featureType,onChange:this.handleChange}))},t.prototype.render=function(){var e=this;return l.default.createElement("form",{className:"span4 offset1",ref:function(t){e.form=t}},l.default.createElement("header",null,l.default.createElement("strong",null,"Editing Cell (",this.props.row,", ",this.props.col,")")),this.renderFields(this.getSanitizedValues()))},t}(l.default.Component);c.propTypes={cell:s.PropTypes.object.isRequired,row:s.PropTypes.number.isRequired,col:s.PropTypes.number.isRequired,onUpdate:s.PropTypes.func.isRequired},t.default=c,e.exports=t.default},2110:function(e,t,n){"use strict";t.Direction={NORTH:0,EAST:1,SOUTH:2,WEST:3},t.PADDLE_BALL_COLLIDE_DISTANCE=.7,t.FINISH_COLLIDE_DISTANCE=.5,t.DEFAULT_BALL_SPEED=.1,t.DEFAULT_BALL_DIRECTION=1.25*Math.PI,t.DEFAULT_PADDLE_SPEED=.1,t.DEFAULT_BALL_START_Y=2,t.Y_TOP_BOUNDARY=-.2,t.SquareType={OPEN:0,WALL:1,GOAL:2,BALLSTART:4,PADDLEFINISH:8,PADDLESTART:16,BALLFINISH:32,OBSTACLE:64}},2395:function(e,t,n){"use strict";var r=function(e,t,n,r,o,i){this.tileType_=e,this.speed_=t,this.size_=n,this.direction_=r,this.emotion_=o,this.sprite_=i};e.exports=r,r.prototype.getTileType=function(){return this.tileType_},r.prototype.clone=function(){return new r(this.tileType_,this.speed_,this.size_,this.direction_,this.emotion_,this.sprite_)},r.prototype.serialize=function(){return{tileType:this.tileType_,speed:this.speed_,size:this.size_,direction:this.direction_,emotion:this.emotion_,sprite:this.sprite_}},r.deserialize=function(e){return new r(e.tileType,e.speed,e.size,e.direction,e.emotion,e.sprite)}},2399:function(e,t,n){"use strict";function r(){var e=(0,a.getStore)();window.addEventListener("resize",(0,i.default)(function(){e.dispatch((0,s.setResponsiveSize)((0,s.getResponsiveBreakpoint)(window.innerWidth)))},100))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(651),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(859),s=n(1206);e.exports=t.default},2401:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(139),p=r(u),c=n(23),d=r(c),f=n(220),h=r(f),g=n(826),T=r(g),m=n(659),y={dialog:{paddingLeft:20,paddingRight:20,paddingBottom:20},instructions:{marginTop:20}},v=function(e){function t(){var n,r,a;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=i(this,e.call.apply(e,[this].concat(l))),r.state={isDialogOpen:r.props.isDialogOpen},r.handleYesClick=function(){r.setState({isDialogOpen:!1}),$.post("/dashboardapi/v1/users/accept_data_transfer_agreement",{user_id:r.props.currentUserId})},a=n,i(r,a)}return a(t,e),t.prototype.render=function(){var e=this.props.studioUrlPrefix,t=e?e+"/users/sign_out":"/users/sign_out";return l.default.createElement(h.default,{useUpdatedStyles:!0,isOpen:this.state.isDialogOpen,style:y.dialog,uncloseable:!0},l.default.createElement("h2",{className:"ui-test-gdpr-dialog"},d.default.gdprDialogHeader()),l.default.createElement("div",null,d.default.gdprDialogDetails()),l.default.createElement("div",{style:y.instructions},l.default.createElement("a",{href:(0,m.pegasus)("/privacy"),className:"ui-test-gdpr-dialog-privacy-link",target:"_blank"},d.default.gdprDialogSeePrivacyPolicy(),".")),l.default.createElement(T.default,null,l.default.createElement(p.default,{text:d.default.gdprDialogLogout(),href:t,color:p.default.ButtonColor.gray,className:"ui-test-gdpr-dialog-logout"}),l.default.createElement(p.default,{text:d.default.gdprDialogYes(),onClick:this.handleYesClick,color:p.default.ButtonColor.orange,className:"ui-test-gdpr-dialog-accept"})))},t}(s.Component);v.propTypes={isDialogOpen:s.PropTypes.bool.isRequired,currentUserId:s.PropTypes.number.isRequired,studioUrlPrefix:s.PropTypes.string},t.default=v,e.exports=t.default},2402:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.initHamburger=void 0;var o=n(34),i=r(o),a=n(451),s=r(a);t.initHamburger=function(){(0,i.default)(function(){(0,i.default)("#hamburger-icon").click(function(e){(0,i.default)(this).toggleClass("active"),(0,i.default)("#hamburger #hamburger-contents").slideToggle(),e.preventDefault()}),(0,i.default)(document).on("click",function(e){var t=(0,i.default)("#hamburger");t.is(e.target)||0!==t.has(e.target).length||(t.children("#hamburger-contents").slideUp(),(0,i.default)("#hamburger-icon").removeClass("active"))}),(0,i.default)(".hamburger-expandable-item").each(function(){(0,i.default)(this).click(function(e){(0,i.default)("#"+(0,i.default)(this).attr("id")+"-items").slideToggle(),(0,i.default)(this).find(".arrow-down").toggle(),(0,i.default)(this).find(".arrow-up").toggle(),e.preventDefault()})}),(0,i.default)("#hamburger #report-bug").click(function(){(0,s.default)("help_ui","report-bug","hamburger")}),(0,i.default)("#hamburger #support").click(function(){(0,s.default)("help_ui","support","hamburger")}),(0,i.default)(".footer #support").click(function(){(0,s.default)("help_ui","support","studio_footer")}),(0,i.default)("#pagefooter #support").each(function(){(0,i.default)(this).click(function(){(0,s.default)("help_ui","support","studio_footer")})})})}},2403:function(e,t,n){"use strict";e.exports=function(e){for(var t,n=e.console=e.console||{},r=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],o=0;o<r.length;o++)t=r[o],n[t]||(n[t]=function(){})}},2404:function(e,t,n){var r,o,i;!function(a,s){o=[n(34),n(2405),n(2406)],r=s,void 0!==(i="function"==typeof r?r.apply(t,o):r)&&(e.exports=i)}(0,function(e,t,n){"use strict";var r=function(e,t){if("string"!=typeof t||t.length){var n="string"==typeof t?new RegExp(t,"i"):t,r=function(e){var t=0;if(3===e.nodeType){var o=e.data.search(n);if(o>=0&&e.data.length>0){var i=e.data.match(n),a=document.createElement("span");a.className="highlight";var s=e.splitText(o),l=(s.splitText(i[0].length),s.cloneNode(!0));a.appendChild(l),s.parentNode.replaceChild(a,s),t=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var u=0;u<e.childNodes.length;++u)u+=r(e.childNodes[u]);return t};return e.each(function(){r(this)})}};e.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()};var o=function(){};o.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[e]:(this._events=this._events||{},void(e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)))},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},o.mixin=function(e){for(var t=["on","off","trigger"],n=0;n<t.length;n++)e.prototype[t[n]]=o.prototype[t[n]]};var i=/Mac/.test(navigator.userAgent),a=i?91:17,s=i?18:17,l=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,u=function(e){return void 0!==e},p=function(e){return void 0===e||null===e?null:"boolean"==typeof e?e?"1":"0":e+""},c=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},d={};d.before=function(e,t,n){var r=e[t];e[t]=function(){return n.apply(e,arguments),r.apply(e,arguments)}},d.after=function(e,t,n){var r=e[t];e[t]=function(){var t=r.apply(e,arguments);return n.apply(e,arguments),t}};var f=function(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}},h=function(e,t){var n;return function(){var r=this,o=arguments;window.clearTimeout(n),n=window.setTimeout(function(){e.apply(r,o)},t)}},g=function(e,t,n){var r,o=e.trigger,i={};e.trigger=function(){var n=arguments[0];if(-1===t.indexOf(n))return o.apply(e,arguments);i[n]=arguments},n.apply(e,[]),e.trigger=o;for(r in i)i.hasOwnProperty(r)&&o.apply(e,i[r])},T=function(e,t,n,r){e.on(t,n,function(t){for(var n=t.target;n&&n.parentNode!==e[0];)n=n.parentNode;return t.currentTarget=n,r.apply(this,[t])})},m=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var n=document.selection.createRange(),r=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),t.start=n.text.length-r,t.length=r}return t},y=function(e,t,n){var r,o,i={};if(n)for(r=0,o=n.length;r<o;r++)i[n[r]]=e.css(n[r]);else i=e.css();t.css(i)},v=function(t,n){if(!t)return 0;var r=e("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");y(n,r,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var o=r.width();return r.remove(),o},S=function(e){var t=null,n=function(n,r){var o,i,a,s,l,u,p,c;n=n||window.event||{},r=r||{},n.metaKey||n.altKey||(r.force||!1!==e.data("grow"))&&(o=e.val(),n.type&&"keydown"===n.type.toLowerCase()&&(i=n.keyCode,a=i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||32===i,46===i||8===i?(c=m(e[0]),c.length?o=o.substring(0,c.start)+o.substring(c.start+c.length):8===i&&c.start?o=o.substring(0,c.start-1)+o.substring(c.start+1):46===i&&void 0!==c.start&&(o=o.substring(0,c.start)+o.substring(c.start+1))):a&&(u=n.shiftKey,p=String.fromCharCode(n.keyCode),p=u?p.toUpperCase():p.toLowerCase(),o+=p)),s=e.attr("placeholder"),!o&&s&&(o=s),(l=v(o,e)+4)!==t&&(t=l,e.width(l),e.triggerHandler("resize")))};e.on("keydown keyup update blur",n),n()},O=function(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML},E=function(n,r){var o,i,a,s,l=this;s=n[0],s.selectize=l;var u=window.getComputedStyle&&window.getComputedStyle(s,null);if(a=u?u.getPropertyValue("direction"):s.currentStyle&&s.currentStyle.direction,a=a||n.parents("[dir]:first").attr("dir")||"",e.extend(l,{order:0,settings:r,$input:n,tabIndex:n.attr("tabindex")||"",tagType:"select"===s.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(a),eventNS:".selectize"+ ++E.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:n.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===r.loadThrottle?l.onSearchChange:h(l.onSearchChange,r.loadThrottle)}),l.sifter=new t(this.options,{diacritics:r.diacritics}),l.settings.options){for(o=0,i=l.settings.options.length;o<i;o++)l.registerOption(l.settings.options[o]);delete l.settings.options}if(l.settings.optgroups){for(o=0,i=l.settings.optgroups.length;o<i;o++)l.registerOptionGroup(l.settings.optgroups[o]);delete l.settings.optgroups}l.settings.mode=l.settings.mode||(1===l.settings.maxItems?"single":"multi"),"boolean"!=typeof l.settings.hideSelected&&(l.settings.hideSelected="multi"===l.settings.mode),l.initializePlugins(l.settings.plugins),l.setupCallbacks(),l.setupTemplates(),l.setup()};return o.mixin(E),void 0!==n?n.mixin(E):function(e,t){t||(t={});console.error("Selectize: "+e),t.explanation&&(console.group&&console.group(),console.error(t.explanation),console.group&&console.groupEnd())}("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),e.extend(E.prototype,{setup:function(){var t,n,r,o,u,p,c,d,f,h,g=this,m=g.settings,y=g.eventNS,v=e(window),O=e(document),E=g.$input;if(c=g.settings.mode,d=E.attr("class")||"",t=e("<div>").addClass(m.wrapperClass).addClass(d).addClass(c),n=e("<div>").addClass(m.inputClass).addClass("items").appendTo(t),r=e('<input type="text" autocomplete="off" />').appendTo(n).attr("tabindex",E.is(":disabled")?"-1":g.tabIndex),p=e(m.dropdownParent||t),o=e("<div>").addClass(m.dropdownClass).addClass(c).hide().appendTo(p),u=e("<div>").addClass(m.dropdownContentClass).appendTo(o),(h=E.attr("id"))&&(r.attr("id",h+"-selectized"),e("label[for='"+h+"']").attr("for",h+"-selectized")),g.settings.copyClassesToDropdown&&o.addClass(d),t.css({width:E[0].style.width}),g.plugins.names.length&&(f="plugin-"+g.plugins.names.join(" plugin-"),t.addClass(f),o.addClass(f)),(null===m.maxItems||m.maxItems>1)&&1===g.tagType&&E.attr("multiple","multiple"),g.settings.placeholder&&r.attr("placeholder",m.placeholder),!g.settings.splitOn&&g.settings.delimiter){var b=g.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");g.settings.splitOn=new RegExp("\\s*"+b+"+\\s*")}E.attr("autocorrect")&&r.attr("autocorrect",E.attr("autocorrect")),E.attr("autocapitalize")&&r.attr("autocapitalize",E.attr("autocapitalize")),g.$wrapper=t,g.$control=n,g.$control_input=r,g.$dropdown=o,g.$dropdown_content=u,o.on("mouseenter","[data-selectable]",function(){return g.onOptionHover.apply(g,arguments)}),o.on("mousedown click","[data-selectable]",function(){return g.onOptionSelect.apply(g,arguments)}),T(n,"mousedown","*:not(input)",function(){return g.onItemSelect.apply(g,arguments)}),S(r),n.on({mousedown:function(){return g.onMouseDown.apply(g,arguments)},click:function(){return g.onClick.apply(g,arguments)}}),r.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return g.onKeyDown.apply(g,arguments)},keyup:function(){return g.onKeyUp.apply(g,arguments)},keypress:function(){return g.onKeyPress.apply(g,arguments)},resize:function(){g.positionDropdown.apply(g,[])},blur:function(){return g.onBlur.apply(g,arguments)},focus:function(){return g.ignoreBlur=!1,g.onFocus.apply(g,arguments)},paste:function(){return g.onPaste.apply(g,arguments)}}),O.on("keydown"+y,function(e){g.isCmdDown=e[i?"metaKey":"ctrlKey"],g.isCtrlDown=e[i?"altKey":"ctrlKey"],g.isShiftDown=e.shiftKey}),O.on("keyup"+y,function(e){e.keyCode===s&&(g.isCtrlDown=!1),16===e.keyCode&&(g.isShiftDown=!1),e.keyCode===a&&(g.isCmdDown=!1)}),O.on("mousedown"+y,function(e){if(g.isFocused){if(e.target===g.$dropdown[0]||e.target.parentNode===g.$dropdown[0])return!1;g.$control.has(e.target).length||e.target===g.$control[0]||g.blur(e.target)}}),v.on(["scroll"+y,"resize"+y].join(" "),function(){g.isOpen&&g.positionDropdown.apply(g,arguments)}),v.on("mousemove"+y,function(){g.ignoreHover=!1}),this.revertSettings={$children:E.children().detach(),tabindex:E.attr("tabindex")},E.attr("tabindex",-1).hide().after(g.$wrapper),e.isArray(m.items)&&(g.setValue(m.items),delete m.items),l&&E.on("invalid"+y,function(e){e.preventDefault(),g.isInvalid=!0,g.refreshState()}),g.updateOriginalInput(),g.refreshItems(),g.refreshState(),g.updatePlaceholder(),g.isSetup=!0,E.is(":disabled")&&g.disable(),g.on("change",this.onChange),E.data("selectize",g),E.addClass("selectized"),g.trigger("initialize"),!0===m.preload&&g.onSearchChange("")},setupTemplates:function(){var t=this,n=t.settings.labelField,r=t.settings.optgroupLabelField,o={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[r])+"</div>"},option:function(e,t){return'<div class="option">'+t(e[n])+"</div>"},item:function(e,t){return'<div class="item">'+t(e[n])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};t.settings.render=e.extend({},o,t.settings.render)},setupCallbacks:function(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)n.hasOwnProperty(e)&&(t=this.settings[n[e]])&&this.on(e,t)},onClick:function(e){var t=this;t.isFocused||(t.focus(),e.preventDefault())},onMouseDown:function(t){var n=this,r=t.isDefaultPrevented();e(t.target);if(n.isFocused){if(t.target!==n.$control_input[0])return"single"===n.settings.mode?n.isOpen?n.close():n.open():r||n.setActiveItem(null),!1}else r||window.setTimeout(function(){n.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(t){var n=this;if(n.isFull()||n.isInputHidden||n.isLocked)return void t.preventDefault();n.settings.splitOn&&setTimeout(function(){var t=n.$control_input.val();if(t.match(n.settings.splitOn))for(var r=e.trim(t).split(n.settings.splitOn),o=0,i=r.length;o<i;o++)n.createItem(r[o])},0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0},onKeyDown:function(e){var t=(e.target,this.$control_input[0],this);if(t.isLocked)return void(9!==e.keyCode&&e.preventDefault());switch(e.keyCode){case 65:if(t.isCmdDown)return void t.selectAll();break;case 27:return void(t.isOpen&&(e.preventDefault(),e.stopPropagation(),t.close()));case 78:if(!e.ctrlKey||e.altKey)break;case 40:if(!t.isOpen&&t.hasOptions)t.open();else if(t.$activeOption){t.ignoreHover=!0;var n=t.getAdjacentOption(t.$activeOption,1);n.length&&t.setActiveOption(n,!0,!0)}return void e.preventDefault();case 80:if(!e.ctrlKey||e.altKey)break;case 38:if(t.$activeOption){t.ignoreHover=!0;var r=t.getAdjacentOption(t.$activeOption,-1);r.length&&t.setActiveOption(r,!0,!0)}return void e.preventDefault();case 13:return void(t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),e.preventDefault()));case 37:return void t.advanceSelection(-1,e);case 39:return void t.advanceSelection(1,e);case 9:return t.settings.selectOnTab&&t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),t.isFull()||e.preventDefault()),void(t.settings.create&&t.createItem()&&e.preventDefault());case 8:case 46:return void t.deleteSelection(e)}return!t.isFull()&&!t.isInputHidden||(i?e.metaKey:e.ctrlKey)?void 0:void e.preventDefault()},onKeyUp:function(e){var t=this;if(t.isLocked)return e&&e.preventDefault();var n=t.$control_input.val()||"";t.lastValue!==n&&(t.lastValue=n,t.onSearchChange(n),t.refreshOptions(),t.trigger("type",n))},onSearchChange:function(e){var t=this,n=t.settings.load;n&&(t.loadedSearches.hasOwnProperty(e)||(t.loadedSearches[e]=!0,t.load(function(r){n.apply(t,[e,r])})))},onFocus:function(e){var t=this,n=t.isFocused;if(t.isDisabled)return t.blur(),e&&e.preventDefault(),!1;t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.onSearchChange(""),n||t.trigger("focus"),t.$activeItems.length||(t.showInput(),t.setActiveItem(null),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())},onBlur:function(e,t){var n=this;if(n.isFocused&&(n.isFocused=!1,!n.ignoreFocus)){if(!n.ignoreBlur&&document.activeElement===n.$dropdown_content[0])return n.ignoreBlur=!0,void n.onFocus(e);var r=function(){n.close(),n.setTextboxValue(""),n.setActiveItem(null),n.setActiveOption(null),n.setCaret(n.items.length),n.refreshState(),t&&t.focus&&t.focus(),n.ignoreFocus=!1,n.trigger("blur")};n.ignoreFocus=!0,n.settings.create&&n.settings.createOnBlur?n.createItem(null,!1,r):r()}},onOptionHover:function(e){this.ignoreHover||this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(t){var n,r,o=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),r=e(t.currentTarget),r.hasClass("create")?o.createItem(null,function(){o.settings.closeAfterSelect&&o.close()}):void 0!==(n=r.attr("data-value"))&&(o.lastQuery=null,o.setTextboxValue(""),o.addItem(n),o.settings.closeAfterSelect?o.close():!o.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&o.setActiveOption(o.getOption(n)))},onItemSelect:function(e){var t=this;t.isLocked||"multi"===t.settings.mode&&(e.preventDefault(),t.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,n=t.$wrapper.addClass(t.settings.loadingClass);t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||n.removeClass(t.settings.loadingClass),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input;t.val()!==e&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e,t){g(this,t?[]:["change"],function(){this.clear(t),this.addItems(e,t)})},setActiveItem:function(t,n){var r,o,i,a,s,l,u,p,c=this;if("single"!==c.settings.mode){if(t=e(t),!t.length)return e(c.$activeItems).removeClass("active"),c.$activeItems=[],void(c.isFocused&&c.showInput());if("mousedown"===(r=n&&n.type.toLowerCase())&&c.isShiftDown&&c.$activeItems.length){for(p=c.$control.children(".active:last"),a=Array.prototype.indexOf.apply(c.$control[0].childNodes,[p[0]]),s=Array.prototype.indexOf.apply(c.$control[0].childNodes,[t[0]]),a>s&&(u=a,a=s,s=u),o=a;o<=s;o++)l=c.$control[0].childNodes[o],-1===c.$activeItems.indexOf(l)&&(e(l).addClass("active"),c.$activeItems.push(l));n.preventDefault()}else"mousedown"===r&&c.isCtrlDown||"keydown"===r&&this.isShiftDown?t.hasClass("active")?(i=c.$activeItems.indexOf(t[0]),c.$activeItems.splice(i,1),t.removeClass("active")):c.$activeItems.push(t.addClass("active")[0]):(e(c.$activeItems).removeClass("active"),c.$activeItems=[t.addClass("active")[0]]);c.hideInput(),this.isFocused||c.focus()}},setActiveOption:function(t,n,r){var o,i,a,s,l,p=this;p.$activeOption&&p.$activeOption.removeClass("active"),p.$activeOption=null,t=e(t),t.length&&(p.$activeOption=t.addClass("active"),!n&&u(n)||(o=p.$dropdown_content.height(),i=p.$activeOption.outerHeight(!0),n=p.$dropdown_content.scrollTop()||0,a=p.$activeOption.offset().top-p.$dropdown_content.offset().top+n,s=a,l=a-o+i,a+i>o+n?p.$dropdown_content.stop().animate({scrollTop:l},r?p.settings.scrollDuration:0):a<n&&p.$dropdown_content.stop().animate({scrollTop:s},r?p.settings.scrollDuration:0)))},selectAll:function(){var e=this;"single"!==e.settings.mode&&(e.$activeItems=Array.prototype.slice.apply(e.$control.children(":not(input)").addClass("active")),e.$activeItems.length&&(e.hideInput(),e.close()),e.focus())},hideInput:function(){var e=this;e.setTextboxValue(""),e.$control_input.css({opacity:0,position:"absolute",left:e.rtl?1e4:-1e4}),e.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0))},blur:function(e){this.$control_input[0].blur(),this.onBlur(null,e)},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return"string"==typeof t&&(t=[{field:t}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t}},search:function(t){var n,r,o,i=this,a=i.settings,s=this.getSearchOptions();if(a.score&&"function"!=typeof(o=i.settings.score.apply(this,[t])))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==i.lastQuery?(i.lastQuery=t,r=i.sifter.search(t,e.extend(s,{score:o})),i.currentResults=r):r=e.extend(!0,{},i.currentResults),a.hideSelected)for(n=r.items.length-1;n>=0;n--)-1!==i.items.indexOf(p(r.items[n].id))&&r.items.splice(n,1);return r},refreshOptions:function(t){var n,o,i,a,s,l,u,c,d,f,h,g,T,m,y,v;void 0===t&&(t=!0);var S=this,E=e.trim(S.$control_input.val()),b=S.search(E),_=S.$dropdown_content,w=S.$activeOption&&p(S.$activeOption.attr("data-value"));for(a=b.items.length,"number"==typeof S.settings.maxOptions&&(a=Math.min(a,S.settings.maxOptions)),s={},l=[],n=0;n<a;n++)for(u=S.options[b.items[n].id],c=S.render("option",u),d=u[S.settings.optgroupField]||"",f=e.isArray(d)?d:[d],o=0,i=f&&f.length;o<i;o++)d=f[o],S.optgroups.hasOwnProperty(d)||(d=""),s.hasOwnProperty(d)||(s[d]=document.createDocumentFragment(),l.push(d)),s[d].appendChild(c);for(this.settings.lockOptgroupOrder&&l.sort(function(e,t){return(S.optgroups[e].$order||0)-(S.optgroups[t].$order||0)}),h=document.createDocumentFragment(),n=0,a=l.length;n<a;n++)d=l[n],S.optgroups.hasOwnProperty(d)&&s[d].childNodes.length?(g=document.createDocumentFragment(),g.appendChild(S.render("optgroup_header",S.optgroups[d])),g.appendChild(s[d]),h.appendChild(S.render("optgroup",e.extend({},S.optgroups[d],{html:O(g),dom:g})))):h.appendChild(s[d]);if(_.html(h),S.settings.highlight&&b.query.length&&b.tokens.length)for(_.removeHighlight(),n=0,a=b.tokens.length;n<a;n++)r(_,b.tokens[n].regex);if(!S.settings.hideSelected)for(n=0,a=S.items.length;n<a;n++)S.getOption(S.items[n]).addClass("selected");T=S.canCreate(E),T&&(_.prepend(S.render("option_create",{input:E})),v=e(_[0].childNodes[0])),S.hasOptions=b.items.length>0||T,S.hasOptions?(b.items.length>0?(y=w&&S.getOption(w),y&&y.length?m=y:"single"===S.settings.mode&&S.items.length&&(m=S.getOption(S.items[0])),m&&m.length||(m=v&&!S.settings.addPrecedence?S.getAdjacentOption(v,1):_.find("[data-selectable]:first"))):m=v,S.setActiveOption(m),t&&!S.isOpen&&S.open()):(S.setActiveOption(null),t&&S.isOpen&&S.close())},addOption:function(t){var n,r,o,i=this;if(e.isArray(t))for(n=0,r=t.length;n<r;n++)i.addOption(t[n]);else(o=i.registerOption(t))&&(i.userOptions[o]=!0,i.lastQuery=null,i.trigger("option_add",o,t))},registerOption:function(e){var t=p(e[this.settings.valueField]);return void 0!==t&&null!==t&&!this.options.hasOwnProperty(t)&&(e.$order=e.$order||++this.order,this.options[t]=e,t)},registerOptionGroup:function(e){var t=p(e[this.settings.optgroupValueField]);return!!t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)},addOptionGroup:function(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)},removeOptionGroup:function(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.renderCache={},this.trigger("optgroup_remove",e))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(t,n){var r,o,i,a,s,l,u,c=this;if(t=p(t),i=p(n[c.settings.valueField]),null!==t&&c.options.hasOwnProperty(t)){if("string"!=typeof i)throw new Error("Value must be set in option data");u=c.options[t].$order,i!==t&&(delete c.options[t],-1!==(a=c.items.indexOf(t))&&c.items.splice(a,1,i)),n.$order=n.$order||u,c.options[i]=n,s=c.renderCache.item,l=c.renderCache.option,s&&(delete s[t],delete s[i]),l&&(delete l[t],delete l[i]),-1!==c.items.indexOf(i)&&(r=c.getItem(t),o=e(c.render("item",n)),r.hasClass("active")&&o.addClass("active"),r.replaceWith(o)),c.lastQuery=null,c.isOpen&&c.refreshOptions(!1)}},removeOption:function(e,t){var n=this;e=p(e);var r=n.renderCache.item,o=n.renderCache.option;r&&delete r[e],o&&delete o[e],delete n.userOptions[e],delete n.options[e],n.lastQuery=null,n.trigger("option_remove",e),n.removeItem(e,t)},clearOptions:function(){var e=this;e.loadedSearches={},e.userOptions={},e.renderCache={},e.options=e.sifter.items={},e.lastQuery=null,e.trigger("option_clear"),e.clear()},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,n){var r=this.$dropdown.find("[data-selectable]"),o=r.index(t)+n;return o>=0&&o<r.length?r.eq(o):e()},getElementWithValue:function(t,n){if(void 0!==(t=p(t))&&null!==t)for(var r=0,o=n.length;r<o;r++)if(n[r].getAttribute("data-value")===t)return e(n[r]);return e()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(t,n){for(var r=e.isArray(t)?t:[t],o=0,i=r.length;o<i;o++)this.isPending=o<i-1,this.addItem(r[o],n)},addItem:function(t,n){g(this,n?[]:["change"],function(){var r,o,i,a,s,l=this,u=l.settings.mode;if(t=p(t),-1!==l.items.indexOf(t))return void("single"===u&&l.close());l.options.hasOwnProperty(t)&&("single"===u&&l.clear(n),"multi"===u&&l.isFull()||(r=e(l.render("item",l.options[t])),s=l.isFull(),l.items.splice(l.caretPos,0,t),l.insertAtCaret(r),(!l.isPending||!s&&l.isFull())&&l.refreshState(),l.isSetup&&(i=l.$dropdown_content.find("[data-selectable]"),l.isPending||(o=l.getOption(t),a=l.getAdjacentOption(o,1).attr("data-value"),l.refreshOptions(l.isFocused&&"single"!==u),a&&l.setActiveOption(l.getOption(a))),!i.length||l.isFull()?l.close():l.positionDropdown(),l.updatePlaceholder(),l.trigger("item_add",t,r),l.updateOriginalInput({silent:n}))))})},removeItem:function(t,n){var r,o,i,a=this;r=t instanceof e?t:a.getItem(t),t=p(r.attr("data-value")),-1!==(o=a.items.indexOf(t))&&(r.remove(),r.hasClass("active")&&(i=a.$activeItems.indexOf(r[0]),a.$activeItems.splice(i,1)),a.items.splice(o,1),a.lastQuery=null,!a.settings.persist&&a.userOptions.hasOwnProperty(t)&&a.removeOption(t,n),o<a.caretPos&&a.setCaret(a.caretPos-1),a.refreshState(),a.updatePlaceholder(),a.updateOriginalInput({silent:n}),a.positionDropdown(),a.trigger("item_remove",t,r))},createItem:function(t,n){var r=this,o=r.caretPos;t=t||e.trim(r.$control_input.val()||"");var i=arguments[arguments.length-1];if("function"!=typeof i&&(i=function(){}),"boolean"!=typeof n&&(n=!0),!r.canCreate(t))return i(),!1;r.lock();var a="function"==typeof r.settings.create?this.settings.create:function(e){var t={};return t[r.settings.labelField]=e,t[r.settings.valueField]=e,t},s=f(function(e){if(r.unlock(),!e||"object"!=typeof e)return i();var t=p(e[r.settings.valueField]);if("string"!=typeof t)return i();r.setTextboxValue(""),r.addOption(e),r.setCaret(o),r.addItem(t),r.refreshOptions(n&&"single"!==r.settings.mode),i(e)}),l=a.apply(this,[t,s]);return void 0!==l&&s(l),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var e=!this.items.length;this.isInvalid=e,this.$control_input.prop("required",e),this.$input.prop("required",!e)},refreshClasses:function(){var t=this,n=t.isFull(),r=t.isLocked;t.$wrapper.toggleClass("rtl",t.rtl),t.$control.toggleClass("focus",t.isFocused).toggleClass("disabled",t.isDisabled).toggleClass("required",t.isRequired).toggleClass("invalid",t.isInvalid).toggleClass("locked",r).toggleClass("full",n).toggleClass("not-full",!n).toggleClass("input-active",t.isFocused&&!t.isInputHidden).toggleClass("dropdown-active",t.isOpen).toggleClass("has-options",!e.isEmptyObject(t.options)).toggleClass("has-items",t.items.length>0),t.$control_input.data("grow",!n&&!r)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(e){var t,n,r,o,i=this;if(e=e||{},1===i.tagType){for(r=[],t=0,n=i.items.length;t<n;t++)o=i.options[i.items[t]][i.settings.labelField]||"",r.push('<option value="'+c(i.items[t])+'" selected="selected">'+c(o)+"</option>");r.length||this.$input.attr("multiple")||r.push('<option value="" selected="selected"></option>'),i.$input.html(r.join(""))}else i.$input.val(i.getValue()),i.$input.attr("value",i.$input.val());i.isSetup&&(e.silent||i.trigger("change",i.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})}},open:function(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.focus(),e.isOpen=!0,e.refreshState(),e.$dropdown.css({visibility:"hidden",display:"block"}),e.positionDropdown(),e.$dropdown.css({visibility:"visible"}),e.trigger("dropdown_open",e.$dropdown))},close:function(){var e=this,t=e.isOpen;"single"===e.settings.mode&&e.items.length&&(e.hideInput(),e.$control_input.blur()),e.isOpen=!1,e.$dropdown.hide(),e.setActiveOption(null),e.refreshState(),t&&e.trigger("dropdown_close",e.$dropdown)},positionDropdown:function(){var e=this.$control,t="body"===this.settings.dropdownParent?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},clear:function(e){var t=this;t.items.length&&(t.$control.children(":not(input)").remove(),t.items=[],t.lastQuery=null,t.setCaret(0),t.setActiveItem(null),t.updatePlaceholder(),t.updateOriginalInput({silent:e}),t.refreshState(),t.showInput(),t.trigger("clear"))},insertAtCaret:function(t){var n=Math.min(this.caretPos,this.items.length);0===n?this.$control.prepend(t):e(this.$control[0].childNodes[n]).before(t),this.setCaret(n+1)},deleteSelection:function(t){var n,r,o,i,a,s,l,u,p,c=this;if(o=t&&8===t.keyCode?-1:1,i=m(c.$control_input[0]),c.$activeOption&&!c.settings.hideSelected&&(l=c.getAdjacentOption(c.$activeOption,-1).attr("data-value")),a=[],c.$activeItems.length){for(p=c.$control.children(".active:"+(o>0?"last":"first")),s=c.$control.children(":not(input)").index(p),o>0&&s++,n=0,r=c.$activeItems.length;n<r;n++)a.push(e(c.$activeItems[n]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(c.isFocused||"single"===c.settings.mode)&&c.items.length&&(o<0&&0===i.start&&0===i.length?a.push(c.items[c.caretPos-1]):o>0&&i.start===c.$control_input.val().length&&a.push(c.items[c.caretPos]));if(!a.length||"function"==typeof c.settings.onDelete&&!1===c.settings.onDelete.apply(c,[a]))return!1;for(void 0!==s&&c.setCaret(s);a.length;)c.removeItem(a.pop());return c.showInput(),c.positionDropdown(),c.refreshOptions(!0),l&&(u=c.getOption(l),u.length&&c.setActiveOption(u)),!0},advanceSelection:function(e,t){var n,r,o,i,a,s=this;0!==e&&(s.rtl&&(e*=-1),n=e>0?"last":"first",r=m(s.$control_input[0]),s.isFocused&&!s.isInputHidden?(i=s.$control_input.val().length,(e<0?0===r.start&&0===r.length:r.start===i)&&!i&&s.advanceCaret(e,t)):(a=s.$control.children(".active:"+n),a.length&&(o=s.$control.children(":not(input)").index(a),s.setActiveItem(null),s.setCaret(e>0?o+1:o))))},advanceCaret:function(e,t){var n,r,o=this;0!==e&&(n=e>0?"next":"prev",o.isShiftDown?(r=o.$control_input[n](),r.length&&(o.hideInput(),o.setActiveItem(r),t&&t.preventDefault())):o.setCaret(o.caretPos+e))},setCaret:function(t){var n=this;if(t="single"===n.settings.mode?n.items.length:Math.max(0,Math.min(n.items.length,t)),!n.isPending){var r,o,i,a;for(i=n.$control.children(":not(input)"),r=0,o=i.length;r<o;r++)a=e(i[r]).detach(),r<t?n.$control_input.before(a):n.$control.append(a)}n.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var e=this;e.$input.prop("disabled",!0),e.$control_input.prop("disabled",!0).prop("tabindex",-1),e.isDisabled=!0,e.lock()},enable:function(){var e=this;e.$input.prop("disabled",!1),e.$control_input.prop("disabled",!1).prop("tabindex",e.tabIndex),e.isDisabled=!1,e.unlock()},destroy:function(){var t=this,n=t.eventNS,r=t.revertSettings;t.trigger("destroy"),t.off(),t.$wrapper.remove(),t.$dropdown.remove(),t.$input.html("").append(r.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:r.tabindex}).show(),t.$control_input.removeData("grow"),t.$input.removeData("selectize"),e(window).off(n),e(document).off(n),e(document.body).off(n),delete t.$input[0].selectize},render:function(t,n){var r,o,i="",a=!1,s=this;return"option"!==t&&"item"!==t||(r=p(n[s.settings.valueField]),a=!!r),a&&(u(s.renderCache[t])||(s.renderCache[t]={}),s.renderCache[t].hasOwnProperty(r))?s.renderCache[t][r]:(i=e(s.settings.render[t].apply(this,[n,c])),"option"===t||"option_create"===t?i.attr("data-selectable",""):"optgroup"===t&&(o=n[s.settings.optgroupValueField]||"",i.attr("data-group",o)),"option"!==t&&"item"!==t||i.attr("data-value",r||""),a&&(s.renderCache[t][r]=i[0]),i[0])},clearCache:function(e){var t=this;void 0===e?t.renderCache={}:delete t.renderCache[e]},canCreate:function(e){var t=this;if(!t.settings.create)return!1;var n=t.settings.createFilter;return e.length&&("function"!=typeof n||n.apply(t,[e]))&&("string"!=typeof n||new RegExp(n).test(e))&&(!(n instanceof RegExp)||n.test(e))}}),E.count=0,E.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},e.fn.selectize=function(t){var n=e.fn.selectize.defaults,r=e.extend({},n,t),o=r.dataAttr,i=r.labelField,a=r.valueField,s=r.optgroupField,l=r.optgroupLabelField,u=r.optgroupValueField,c=function(t,n){var s,l,u,p,c=t.attr(o);if(c)for(n.options=JSON.parse(c),s=0,l=n.options.length;s<l;s++)n.items.push(n.options[s][a]);else{var d=e.trim(t.val()||"");if(!r.allowEmptyOption&&!d.length)return;for(u=d.split(r.delimiter),s=0,l=u.length;s<l;s++)p={},p[i]=u[s],p[a]=u[s],n.options.push(p);n.items=u}},d=function(t,n){var c,d,f,h,g=n.options,T={},m=function(e){var t=o&&e.attr(o);return"string"==typeof t&&t.length?JSON.parse(t):null},y=function(t,o){t=e(t);var l=p(t.val());if(l||r.allowEmptyOption)if(T.hasOwnProperty(l)){if(o){var u=T[l][s];u?e.isArray(u)?u.push(o):T[l][s]=[u,o]:T[l][s]=o}}else{var c=m(t)||{};c[i]=c[i]||t.text(),c[a]=c[a]||l,c[s]=c[s]||o,T[l]=c,g.push(c),t.is(":selected")&&n.items.push(l)}};for(n.maxItems=t.attr("multiple")?null:1,h=t.children(),c=0,d=h.length;c<d;c++)f=h[c].tagName.toLowerCase(),"optgroup"===f?function(t){var r,o,i,a,s;for(t=e(t),i=t.attr("label"),i&&(a=m(t)||{},a[l]=i,a[u]=i,n.optgroups.push(a)),s=e("option",t),r=0,o=s.length;r<o;r++)y(s[r],i)}(h[c]):"option"===f&&y(h[c])};return this.each(function(){if(!this.selectize){var o=e(this),i=this.tagName.toLowerCase(),a=o.attr("placeholder")||o.attr("data-placeholder");a||r.allowEmptyOption||(a=o.children('option[value=""]').text());var s={placeholder:a,options:[],optgroups:[],items:[]};"select"===i?d(o,s):c(o,s),new E(o,e.extend(!0,{},n,s,t))}})},e.fn.selectize.defaults=E.defaults,e.fn.selectize.support={validity:l},E.define("drag_drop",function(t){if(!e.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var n=this;n.lock=function(){var e=n.lock;return function(){var t=n.$control.data("sortable");return t&&t.disable(),e.apply(n,arguments)}}(),n.unlock=function(){var e=n.unlock;return function(){var t=n.$control.data("sortable");return t&&t.enable(),e.apply(n,arguments)}}(),n.setup=function(){var t=n.setup;return function(){t.apply(this,arguments);var r=n.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:n.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),r.css({overflow:"visible"})},stop:function(){r.css({overflow:"hidden"});var t=n.$activeItems?n.$activeItems.slice():null,o=[];r.children("[data-value]").each(function(){o.push(e(this).attr("data-value"))}),n.setValue(o),n.setActiveItem(t)}})}}()}}),E.define("dropdown_header",function(t){var n=this;t=e.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a></div></div>'}},t),n.setup=function(){var r=n.setup;return function(){r.apply(n,arguments),n.$dropdown_header=e(t.html(t)),n.$dropdown.prepend(n.$dropdown_header)}}()}),E.define("optgroup_columns",function(t){var n=this;t=e.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,n){var r=t.closest("[data-group]").find("[data-selectable]"),o=r.index(t)+n;return o>=0&&o<r.length?r.eq(o):e()},this.onKeyDown=function(){var e=n.onKeyDown;return function(t){var r,o,i,a;return!this.isOpen||37!==t.keyCode&&39!==t.keyCode?e.apply(this,arguments):(n.ignoreHover=!0,a=this.$activeOption.closest("[data-group]"),r=a.find("[data-selectable]").index(this.$activeOption),a=37===t.keyCode?a.prev("[data-group]"):a.next("[data-group]"),i=a.find("[data-selectable]"),o=i.eq(Math.min(i.length-1,r)),void(o.length&&this.setActiveOption(o)))}}();var r=function(){var e,t=r.width,n=document;return void 0===t&&(e=n.createElement("div"),e.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,n.body.appendChild(e),t=r.width=e.offsetWidth-e.clientWidth,n.body.removeChild(e)),t},o=function(){var o,i,a,s,l,u,p;if(p=e("[data-group]",n.$dropdown_content),(i=p.length)&&n.$dropdown_content.width()){if(t.equalizeHeight){for(a=0,o=0;o<i;o++)a=Math.max(a,p.eq(o).height());p.css({height:a})}t.equalizeWidth&&(u=n.$dropdown_content.innerWidth()-r(),s=Math.round(u/i),p.css({width:s}),i>1&&(l=u-s*(i-1),p.eq(i-1).css({width:l})))}};(t.equalizeHeight||t.equalizeWidth)&&(d.after(this,"positionDropdown",o),d.after(this,"refreshOptions",o))}),E.define("remove_button",function(t){t=e.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);if("single"===this.settings.mode)return void function(t,n){n.className="remove-single";var r=t,o='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+c(n.title)+'">'+n.label+"</a>",i=function(e,t){return e+t};t.setup=function(){var a=r.setup;return function(){if(n.append){var s=e(r.$input.context).attr("id"),l=(e("#"+s),r.settings.render.item);r.settings.render.item=function(e){return i(l.apply(t,arguments),o)}}a.apply(t,arguments),t.$control.on("click","."+n.className,function(e){e.preventDefault(),r.isLocked||r.clear()})}}()}(this,t);!function(t,n){var r=t,o='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+c(n.title)+'">'+n.label+"</a>",i=function(e,t){var n=e.search(/(<\/[^>]+>\s*)$/);return e.substring(0,n)+t+e.substring(n)};t.setup=function(){var a=r.setup;return function(){if(n.append){var s=r.settings.render.item;r.settings.render.item=function(e){return i(s.apply(t,arguments),o)}}a.apply(t,arguments),t.$control.on("click","."+n.className,function(t){if(t.preventDefault(),!r.isLocked){var n=e(t.currentTarget).parent();r.setActiveItem(n),r.deleteSelection()&&r.setCaret(r.items.length)}})}}()}(this,t)}),E.define("restore_on_backspace",function(e){var t=this;e.text=e.text||function(e){return e[this.settings.labelField]},this.onKeyDown=function(){var n=t.onKeyDown;return function(t){var r,o;return 8===t.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(r=this.caretPos-1)>=0&&r<this.items.length?(o=this.options[this.items[r]],this.deleteSelection(t)&&(this.setTextboxValue(e.text.apply(this,[o])),this.refreshOptions(!0)),void t.preventDefault()):n.apply(this,arguments)}}()}),E})},2405:function(e,t,n){var r,o;!function(i,a){r=a,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o)}(0,function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){if(!(e=o(String(e||"").toLowerCase()))||!e.length)return[];var t,n,r,a,l=[],u=e.split(/ +/);for(t=0,n=u.length;t<n;t++){if(r=i(u[t]),this.settings.diacritics)for(a in s)s.hasOwnProperty(a)&&(r=r.replace(new RegExp(a,"g"),s[a]));l.push({string:u[t],regex:new RegExp(r,"i")})}return l},e.prototype.iterator=function(e,t){var n;n=a(e)?Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e(this[t],t,this)}:function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)},n.apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var n,o,i,a,s;n=this,e=n.prepareSearch(e,t),i=e.tokens,o=e.options.fields,a=i.length,s=e.options.nesting;var l=function(e,t){var n,r;return e?(e=String(e||""),-1===(r=e.search(t.regex))?0:(n=t.string.length/e.length,0===r&&(n+=.5),n)):0},u=function(){var e=o.length;return e?1===e?function(e,t){return l(r(t,o[0],s),e)}:function(t,n){for(var i=0,a=0;i<e;i++)a+=l(r(n,o[i],s),t);return a/e}:function(){return 0}}();return a?1===a?function(e){return u(i[0],e)}:"and"===e.options.conjunction?function(e){for(var t,n=0,r=0;n<a;n++){if((t=u(i[n],e))<=0)return 0;r+=t}return r/a}:function(e){for(var t=0,n=0;t<a;t++)n+=u(i[t],e);return n/a}:function(){return 0}},e.prototype.getSortFunction=function(e,n){var o,i,a,s,l,u,p,c,d,f,h;if(a=this,e=a.prepareSearch(e,n),h=!e.query&&n.sort_empty||n.sort,d=function(e,t){return"$score"===e?t.score:r(a.items[t.id],e,n.nesting)},l=[],h)for(o=0,i=h.length;o<i;o++)(e.query||"$score"!==h[o].field)&&l.push(h[o]);if(e.query){for(f=!0,o=0,i=l.length;o<i;o++)if("$score"===l[o].field){f=!1;break}f&&l.unshift({field:"$score",direction:"desc"})}else for(o=0,i=l.length;o<i;o++)if("$score"===l[o].field){l.splice(o,1);break}for(c=[],o=0,i=l.length;o<i;o++)c.push("desc"===l[o].direction?-1:1);return u=l.length,u?1===u?(s=l[0].field,p=c[0],function(e,n){return p*t(d(s,e),d(s,n))}):function(e,n){var r,o,i;for(r=0;r<u;r++)if(i=l[r].field,o=c[r]*t(d(i,e),d(i,n)))return o;return 0}:null},e.prototype.prepareSearch=function(e,t){if("object"==typeof e)return e;t=n({},t);var r=t.fields,o=t.sort,i=t.sort_empty;return r&&!a(r)&&(t.fields=[r]),o&&!a(o)&&(t.sort=[o]),i&&!a(i)&&(t.sort_empty=[i]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,t){var n,r,o,i,a=this;return r=this.prepareSearch(e,t),t=r.options,e=r.query,i=t.score||a.getScoreFunction(r),e.length?a.iterator(a.items,function(e,o){n=i(e),(!1===t.filter||n>0)&&r.items.push({score:n,id:o})}):a.iterator(a.items,function(e,t){r.items.push({score:1,id:t})}),o=a.getSortFunction(r,t),o&&r.items.sort(o),r.total=r.items.length,"number"==typeof t.limit&&(r.items=r.items.slice(0,t.limit)),r};var t=function(e,t){return"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=l(String(e||"")),t=l(String(t||"")),e>t?1:t>e?-1:0)},n=function(e,t){var n,r,o,i;for(n=1,r=arguments.length;n<r;n++)if(i=arguments[n])for(o in i)i.hasOwnProperty(o)&&(e[o]=i[o]);return e},r=function(e,t,n){if(e&&t){if(!n)return e[t];for(var r=t.split(".");r.length&&(e=e[r.shift()]););return e}},o=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},i=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},a=Array.isArray||"undefined"!=typeof $&&$.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s={a:"[a]",b:"[bB]",c:"[cCc]",d:"[dDd]",e:"[e]",f:"[f]",g:"[g]",h:"[h]",i:"[iiI]",j:"[j]",k:"[k]",l:"[l]",n:"[nNn]",o:"[o]",p:"[p]",q:"[qq]",r:"[r]",s:"[sSs]",t:"[t]",u:"[u]",v:"[v]",w:"[w]",x:"[x]",y:"[y]",z:"[z]"},l=function(){var e,t,n,r,o="",i={};for(n in s)if(s.hasOwnProperty(n))for(r=s[n].substring(2,s[n].length-1),o+=r,e=0,t=r.length;e<t;e++)i[r.charAt(e)]=n;var a=new RegExp("["+o+"]","g");return function(e){return e.replace(a,function(e){return i[e]}).toLowerCase()}}();return e})},2406:function(e,t,n){var r,o;!function(i,a){r=a,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o)}(0,function(){var e={};e.mixin=function(e){e.plugins={},e.prototype.initializePlugins=function(e){var n,r,o,i=this,a=[];if(i.plugins={names:[],settings:{},requested:{},loaded:{}},t.isArray(e))for(n=0,r=e.length;n<r;n++)"string"==typeof e[n]?a.push(e[n]):(i.plugins.settings[e[n].name]=e[n].options,a.push(e[n].name));else if(e)for(o in e)e.hasOwnProperty(o)&&(i.plugins.settings[o]=e[o],a.push(o));for(;a.length;)i.require(a.shift())},e.prototype.loadPlugin=function(t){var n=this,r=n.plugins,o=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');r.requested[t]=!0,r.loaded[t]=o.fn.apply(n,[n.plugins.settings[t]||{}]),r.names.push(t)},e.prototype.require=function(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]},e.define=function(t,n){e.plugins[t]={name:t,fn:n}}};var t={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}};return e})},2407:function(e,t,n){"use strict";var r=n(1),o=r.PropTypes.arrayOf(r.PropTypes.shape({id:r.PropTypes.number,name:r.PropTypes.string}));e.exports.studentsShape=o},3107:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(34),i=r(o),a=n(1),s=r(a),l=n(39),u=r(l),p=n(859),c=n(1253),d=n(2461),f=r(d),h=n(2399),g=r(h),T=n(2400),m=r(T),y=n(2401),v=r(y),S=n(643),O=r(S),E=n(3109),b=n(2402),_=n(818);(0,p.getStore)().dispatch((0,c.setRtlFromDOM)()),n(2403)(window);var w=n(661),C=n(3110);window.React=n(1),window.ReactDOM=n(39),window.Radium=n(55),n(1040),n(3111),n(1192),n(1535),n(3112),n(3121),n(2404),i.default.fn.modal&&(i.default.fn.modal.Constructor.prototype.enforceFocus=function(){}),window.dashboard=window.dashboard||{},window.dashboard.clientState=n(666),window.dashboard.createCallouts=n(1060).default,window.dashboard.hashEmail=m.default,window.dashboard.levelCompletions=n(3122),window.dashboard.popupWindow=n(1396),window.dashboard.reporting=n(2108),window.dashboard.header=n(1392),window.dashboard.videos=n(1441),window.dashboard.assets=n(1436),window.dashboard.pairing=n(3123),window.dashboard.teacher=n(1395),window.dashboard.project=n(579),window.dashboard.codeStudioLevels={registerGetResult:_.registerGetResult,registerLevel:_.registerLevel,onAnswerChanged:_.onAnswerChanged},window.Dialog=n(809),window.FreeResponse=n(3128),window.Multi=n(2408),window.TextMatch=n(2409);var A=window.onerror;window.onerror=function(e,t,n){if(/^Script error/.test(e)&&t&&(arguments[0]="Script Error: "+t),A)return A.apply(this,arguments)};(0,i.default)(document).keydown(function(e){27===e.keyCode&&(e.stopPropagation(),e.preventDefault())}),setTimeout(function(){(0,i.default)("#codeApp .slow_load").show()},1e4),(0,i.default)(document).ready(function(){if(document.querySelector("script[data-gdpr]")){var e=(0,O.default)("gdpr");e.show_gdpr_dialog&&e.current_user_id&&u.default.render(s.default.createElement(v.default,{isDialogOpen:e.show_gdpr_dialog,currentUserId:e.current_user_id}),document.getElementById("gdpr-dialog"))}}),C(),window.CDOSounds=w.getSingleton(),(0,E.checkForUnsupportedBrowsersOnLoad)(),(0,b.initHamburger)(),(0,f.default)(),(0,g.default)()},3109:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkForUnsupportedBrowsersOnLoad=void 0;var r=n(2012),o=n(34),i=function(e){return e&&e.__esModule?e:{default:e}}(o);t.checkForUnsupportedBrowsersOnLoad=function(){(0,i.default)(document).ready(function(){var e=null,t=!1;(0,r.isUnsupportedBrowser)()?e="#unsupported-browser":"undefined"!=typeof appOptions&&((0,r.isMobileDevice)()?("applab"===appOptions.app?e="#applab-unsupported-tablet":"gamelab"!==appOptions.app||appOptions.valueTypeTabShapeMap||(e="#gamelab-unsupported-tablet"),t=!0):(0,r.isIE11)()&&"weblab"===appOptions.app?(e="#weblab-unsupported-browser",t=!0):"weblab"!==appOptions.app||(0,r.isStorageAvailable)("localStorage")||(e="#weblab-unsupported-local-storage",t=!0)),e&&((0,i.default)(e).show(),t?(0,i.default)("#dismiss-icon").show():(0,i.default)("#warning-icon").show(),(0,i.default)("#warning-banner").show())})}},3110:function(e,t,n){"use strict";var r=n(34),o=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n(1441).showVideoDialog,a=function(e,t){var n=function(e){t(e),e.preventDefault()};e.on({touchstart:n,click:n})};e.exports=function(){(0,o.default)(window).load(function(){0!==(0,o.default)("#reference_area").length&&((0,o.default)(".video_link").each(function(){a((0,o.default)(this),o.default.proxy(function(){i({src:(0,o.default)(this).attr("data-src"),name:(0,o.default)(this).attr("data-name"),key:(0,o.default)(this).attr("data-key"),download:(0,o.default)(this).attr("data-download"),thumbnail:(0,o.default)(this).attr("data-thumbnail"),enable_fallback:!0,autoplay:!0},!0)},this))}),(0,o.default)("#reference_area_target").append((0,o.default)("#reference_area")),(0,o.default)("#reference_area_target").data("minimal")&&(0,o.default)("#reference_area .video_thumbnail").hide())})}},3111:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getChannelIdFromUrl=void 0;var s=n(1),l=r(s),u=n(39),p=r(u),c=n(68),d=r(c),f=window.alert,h=t.getChannelIdFromUrl=function(e){var t=void 0;return(t=e.indexOf("codeprojects")>=0?/.*codeprojects.*[^\/]+\/([^\/]+)/.exec(e):/.*\/projects\/[^\/]+\/([^\/]+)/.exec(e))&&t[1]},g=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.render=function(){var e=d.default.assign({},{width:514},this.props.style),t=this.props.age&&this.props.age.toString(),n=["","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21+"];if(null!==this.props.age&&-1===n.indexOf(t))throw new Error("Invalid age: "+t);return l.default.createElement("select",{name:"age",style:e,defaultValue:t},n.map(function(e){return l.default.createElement("option",{key:e,value:e},e)}))},t}(l.default.Component);g.propTypes={age:s.PropTypes.oneOfType([s.PropTypes.string,s.PropTypes.number]),style:s.PropTypes.object};var T=function(e){function t(){var n,r,a;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=i(this,e.call.apply(e,[this].concat(l))),r.handleSubmit=function(e){var t=r.props.i18n;return""===r.refs.email.value?(f(t.t("project.abuse.report_abuse_form.validation.email")),void e.preventDefault()):""===p.default.findDOMNode(r.refs.age).value?(f(t.t("project.abuse.report_abuse_form.validation.age")),void e.preventDefault()):""===r.refs.abuse_type.value?(f(t.t("project.abuse.report_abuse_form.validation.abuse_type")),void e.preventDefault()):""===r.refs.abuse_detail.value?(f(t.t("project.abuse.report_abuse_form.validation.abuse_detail")),void e.preventDefault()):void 0},a=n,i(r,a)}return a(t,e),t.prototype.getChannelId=function(){var e=this.props.abuseUrl;return h(e)},t.prototype.render=function(){var e=this.props.i18n;return l.default.createElement("div",{style:{width:514}},l.default.createElement("h2",null,e.t("footer.report_abuse")),l.default.createElement("p",null,e.t("project.abuse.report_abuse_form.intro")),l.default.createElement("br",null),l.default.createElement("form",{action:"/report_abuse",method:"post"},l.default.createElement("input",{type:"hidden",name:"authenticity_token",value:this.props.csrfToken}),l.default.createElement("input",{type:"hidden",name:"channel_id",value:this.getChannelId()}),l.default.createElement("input",{type:"hidden",name:"name",value:this.props.name}),l.default.createElement("div",{style:{display:this.props.email?"none":"block"}},l.default.createElement("div",null,e.t("activerecord.attributes.user.email")),l.default.createElement("input",{type:"text",style:{width:500},defaultValue:this.props.email,name:"email",ref:"email"})),l.default.createElement("div",{style:{display:this.props.age?"none":"block"}},l.default.createElement("div",null,e.t("activerecord.attributes.user.age")),l.default.createElement(g,{age:this.props.age,ref:"age"})),l.default.createElement("div",null,e.t("project.abuse.report_abuse_form.abusive_url")),l.default.createElement("input",{type:"text",readOnly:!!this.props.abuseUrl,style:{width:500},defaultValue:this.props.abuseUrl,name:"abuse_url"}),l.default.createElement("div",{dangerouslySetInnerHTML:{__html:e.t("project.abuse.report_abuse_form.abuse_type.question",{link_start:'<a href="https://code.org/tos" target="_blank">',link_end:"</a>"})}}),l.default.createElement("select",{style:{width:514},name:"abuse_type",ref:"abuse_type"},l.default.createElement("option",{value:""}),l.default.createElement("option",{value:"harassment"},e.t("project.abuse.report_abuse_form.abuse_type.harassment")),l.default.createElement("option",{value:"offensive"},e.t("project.abuse.report_abuse_form.abuse_type.offensive")),l.default.createElement("option",{value:"infringement"},e.t("project.abuse.report_abuse_form.abuse_type.infringement")),l.default.createElement("option",{value:"other"},e.t("project.abuse.report_abuse_form.abuse_type.other"))),l.default.createElement("div",null,e.t("project.abuse.report_abuse_form.detail")),l.default.createElement("textarea",{style:{width:500,height:100},name:"abuse_detail",ref:"abuse_detail"}),l.default.createElement("div",{dangerouslySetInnerHTML:{__html:e.t("project.abuse.report_abuse_form.acknowledge",{link_start_privacy:'<a href="https://code.org/privacy" target="_blank">',link_start_tos:'<a href="https://code.org/tos" target="_blank">',link_end:"</a>"})}}),l.default.createElement("button",{onClick:this.handleSubmit},e.t("submit"))))},t}(l.default.Component);T.propTypes={i18n:s.PropTypes.object.isRequired,csrfToken:s.PropTypes.string.isRequired,abuseUrl:s.PropTypes.string.isRequired,name:s.PropTypes.string,email:s.PropTypes.string,age:s.PropTypes.oneOfType([s.PropTypes.string,s.PropTypes.number])},t.default=T,window.dashboard=window.dashboard||{},window.dashboard.ReportAbuseForm=T},3112:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=n(1203),u=n(2395),p=n(3113),c=n(3114),d=n(3115),f=n(1551),h=n(3116),g=n(3117),T=n(3119),m=n(3120),y=function(e){function t(){var n,i,a;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=o(this,e.call.apply(e,[this].concat(l))),i.handleChange=function(e){i.props.onChange(JSON.parse(e.target.value))},a=n,o(i,a)}return i(t,e),t.prototype.componentDidUpdate=function(){var e=this.refs.serializedInput;e.focus(),e.select()},t.prototype.render=function(){return s.default.createElement("label",null,"Cell JSON (for copy/pasting):",s.default.createElement("input",{type:"text",value:JSON.stringify(this.props.serialization),ref:"serializedInput",onChange:this.handleChange}))},t}(s.default.Component);y.propTypes={serialization:a.PropTypes.object.isRequired,onChange:a.PropTypes.func.isRequired};var v=function(e){function t(n){r(this,t);var i=o(this,e.call(this,n));S.call(i);var a=void 0,s=i.getCellClass();return a=n.serializedMaze?n.serializedMaze.map(function(e){return e.map(s.deserialize)}):n.maze.map(function(e,t){return e.map(function(e,r){var o=n.initialDirt[t][r];return s.parseFromOldValues(e,o)})}),i.state={cells:a},i}return i(t,e),t.prototype.getCellClass=function(){return"playlab"===this.props.skin||"starwarsgrid"===this.props.skin?u:l.utils.isBeeSkin(this.props.skin)?l.cells.BeeCell:l.utils.isHarvesterSkin(this.props.skin)?l.cells.HarvesterCell:l.utils.isPlanterSkin(this.props.skin)?l.cells.PlanterCell:l.cells.Cell},t.prototype.getEditorClass=function(){return"bounce"===this.props.skin?T:"playlab"===this.props.skin?h:"starwarsgrid"===this.props.skin?g:l.utils.isBeeSkin(this.props.skin)?d:l.utils.isHarvesterSkin(this.props.skin)?p:l.utils.isPlanterSkin(this.props.skin)?c:f},t.prototype.updateCells=function(e,t,n){var r=this;if(void 0!==n&&void 0!==e&&void 0!==t){var o=this.state.cells;n.forEach(function(n,i){n.forEach(function(n,a){o[e+i]&&o[e+i][t+a]&&(o[e+i][t+a]=r.getCellClass().deserialize(n))})});var i=o.map(function(e){return e.map(function(e){return e.serialize()})});this.props.onUpdate(i),this.setState({cells:o})}},t.prototype.render=function(){var e=this.state.cells,t=void 0,n=void 0,r=void 0,o=this.state.selectedRow,i=this.state.selectedCol;if(e[o]&&e[o][i]){var a=e[o][i],l=this.getEditorClass();t=s.default.createElement(l,{cell:a,row:o,col:i,onUpdate:this.handleCellChange}),n=s.default.createElement(y,{serialization:a.serialize(),onChange:this.handleCellChange}),this.state.copiedCells&&(r=s.default.createElement("button",{type:"button",onClick:this.pasteCopiedCells},"Paste Selected "+this.state.copiedCells.length+"x"+this.state.copiedCells[0].length+" Cells"))}return s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"span5"},s.default.createElement(m,{cells:e,selectedRow:this.state.selectedRow,selectedCol:this.state.selectedCol,skin:this.props.skin,setCopiedCells:this.setCopiedCells,onSelectionChange:this.changeSelection}),n,r),t)},t}(s.default.Component);v.propTypes={serializedMaze:a.PropTypes.arrayOf(a.PropTypes.arrayOf(a.PropTypes.object)),maze:a.PropTypes.arrayOf(a.PropTypes.array),initialDirt:a.PropTypes.arrayOf(a.PropTypes.arrayOf(a.PropTypes.number)),skin:a.PropTypes.string.isRequired,onUpdate:a.PropTypes.func.isRequired};var S=function(){var e=this;this.changeSelection=function(t,n){e.setState({selectedRow:t,selectedCol:n})},this.handleCellChange=function(t){var n=e.state.selectedRow,r=e.state.selectedCol;e.updateCells(n,r,[[t]])},this.pasteCopiedCells=function(){var t=e.state.copiedCells,n=e.state.selectedRow,r=e.state.selectedCol;e.updateCells(n,r,t)},this.setCopiedCells=function(t){e.setState({copiedCells:t})}};t.default=v,window.dashboard=window.dashboard||{},window.dashboard.GridEditor=v,e.exports=t.default},3113:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(1551),p=r(u),c=n(1203),d=c.cells.HarvesterCell,f=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.renderFields=function(t){return l.default.createElement("div",null,e.prototype.renderFields.call(this,t),l.default.createElement("label",{htmlFor:"possibleFeatures"},"Possible Features:"),Object.keys(d.FeatureType).map(function(e){var n=d.FeatureType[e];return l.default.createElement("label",{className:"checkbox",key:e},l.default.createElement("input",{type:"checkbox",name:"possibleFeatures",value:n,checked:t.possibleFeatures.includes(n),onChange:this.handleChange}),e)},this),l.default.createElement("label",{htmlFor:"startsHidden"},"Starts Hidden:"),l.default.createElement("input",{style:{margin:0},type:"checkbox",name:"startsHidden",checked:t.startsHidden,value:1,onChange:this.handleChange}))},t}(p.default);t.default=f,e.exports=t.default},3114:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(1551),p=r(u),c=n(1203),d=c.cells.PlanterCell,f=c.tiles.SquareType,h=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.getSelectFieldNames=function(){return["tileType","featureType"]},t.prototype.renderFields=function(e){return l.default.createElement("div",null,this.renderTileTypes(e),l.default.createElement("label",{htmlFor:"featureType"},"Feature Type:"),l.default.createElement("select",{name:"featureType",value:e.featureType,disabled:this.props.cell.getTile()!==f.OPEN,onChange:this.handleChange},Object.keys(d.FeatureType).map(function(e){return l.default.createElement("option",{key:e,value:d.FeatureType[e]},e.toLowerCase())})))},t}(p.default);t.default=h,e.exports=t.default},3115:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(1551),p=r(u),c=n(1203),d=c.cells.BeeCell,f=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.getSelectFieldNames=function(){return e.prototype.getSelectFieldNames.call(this).concat(["featureType","cloudType","flowerColor"])},t.prototype.getSanitizedValues=function(){var t=e.prototype.getSanitizedValues.call(this);return this.props.cell.isVariableCloud()&&(t.featureType=d.FeatureType.VARIABLE),"undefined"===t.featureType&&(t.value="",t.range=""),this.props.cell.isFlower()||(t.flowerColor=""),t},t.prototype.renderFields=function(t){return l.default.createElement("div",null,e.prototype.renderFields.call(this,t),l.default.createElement("label",{htmlFor:"featureType"},"Feature Type:"),l.default.createElement("select",{name:"featureType",value:t.featureType,disabled:this.props.cell.isVariableCloud(),onChange:this.handleChange},l.default.createElement("option",{value:"undefined"},"none"),l.default.createElement("option",{value:d.FeatureType.HIVE},"hive"),l.default.createElement("option",{value:d.FeatureType.FLOWER},"flower"),l.default.createElement("option",{value:d.FeatureType.VARIABLE},"variable")),l.default.createElement("label",{htmlFor:"cloudType"},"Cloud Type:"),l.default.createElement("select",{name:"cloudType",value:t.cloudType,onChange:this.handleChange},l.default.createElement("option",{value:"undefined"},"none"),l.default.createElement("option",{value:d.CloudType.STATIC},"classic"),l.default.createElement("option",{value:d.CloudType.HIVE_OR_FLOWER},"hive or flower"),l.default.createElement("option",{value:d.CloudType.FLOWER_OR_NOTHING},"flower or nothing"),l.default.createElement("option",{value:d.CloudType.HIVE_OR_NOTHING},"hive or nothing"),l.default.createElement("option",{value:d.CloudType.ANY},"any")),l.default.createElement("label",{htmlFor:"flowerColor"},"Flower Color:"),l.default.createElement("select",{name:"flowerColor",value:t.flowerColor,disabled:!this.props.cell.isFlower(),onChange:this.handleChange},l.default.createElement("option",{value:"undefined"},"default"),l.default.createElement("option",{value:d.FlowerColor.RED},"red"),l.default.createElement("option",{value:d.FlowerColor.PURPLE},"purple")))},t}(p.default);t.default=f,e.exports=t.default},3116:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1047),l=n(1),u=r(l),p=n(1551),c=r(p),d=["dog","cat","penguin","dinosaur","octopus","witch","bat","bird","dragon","squirrel","wizard","alien","ghost","monster","robot","unicorn","zombie","knight","ninja","pirate","caveboy","cavegirl","princess","spacebot","soccergirl","soccerboy","tennisgirl","tennisboy"],f={OPEN:s.SquareType.OPEN,GOAL:s.SquareType.SPRITEFINISH,START:s.SquareType.SPRITESTART},h=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.getSelectFieldNames=function(){return e.prototype.getSelectFieldNames.call(this).concat(["speed","size","direction","emotion","sprite"])},t.prototype.renderFields=function(t){return u.default.createElement("div",null,e.prototype.renderTileTypes.call(this,t,f),t.tileType===s.SquareType.SPRITESTART&&u.default.createElement("div",null,u.default.createElement("label",{htmlFor:"sprite"},"Sprite:"),u.default.createElement("select",{name:"sprite",value:t.sprite,onChange:this.handleChange},u.default.createElement("option",{value:"undefined"},"default"),d.map(function(e,t){return u.default.createElement("option",{key:e,value:t},e)})),u.default.createElement("label",{htmlFor:"speed"},"Speed: "),u.default.createElement("select",{name:"speed",value:t.speed,onChange:this.handleChange},u.default.createElement("option",{value:"undefined"},"default"),Object.keys(s.SpriteSpeed).map(function(e){return u.default.createElement("option",{key:e,value:s.SpriteSpeed[e]},e.replace(/_/g," ").toLowerCase())})),u.default.createElement("label",{htmlFor:"size"},"Size: "),u.default.createElement("select",{name:"size",value:t.size,onChange:this.handleChange},u.default.createElement("option",{value:"undefined"},"default"),Object.keys(s.SpriteSize).map(function(e){return u.default.createElement("option",{key:e,value:s.SpriteSize[e]},e.replace(/_/g," ").toLowerCase())})),u.default.createElement("label",{htmlFor:"direction"},"Direction: "),u.default.createElement("select",{name:"direction",value:t.direction,onChange:this.handleChange},u.default.createElement("option",{value:"undefined"},"default"),Object.keys(s.Direction).map(function(e){return u.default.createElement("option",{key:e,value:s.Direction[e]},e.replace(/_/g," ").toLowerCase())})),u.default.createElement("label",{htmlFor:"emotion"},"Emotion: "),u.default.createElement("select",{name:"emotion",value:t.emotion,onChange:this.handleChange},u.default.createElement("option",{value:"undefined"},"default"),Object.keys(s.Emotions).map(function(e){return u.default.createElement("option",{key:e,value:s.Emotions[e]},e.replace(/_/g," ").toLowerCase())}))))},t}(c.default);t.default=h,e.exports=t.default},3117:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=n(1),u=r(l),p=n(1047),c=n(3118),d=r(c),f=n(1551),h=r(f),g={empty:0,start:16,goal:1,crate_1:65536,crate_2:1048576,crate_3:131072,canister:1179648,covered_crates_1a:262144,covered_crates_1b:1310720,covered_crates_2a:2359296,covered_crates_2b:2424832,covered_crates_3a:3407872,covered_crates_3b:3473408},T={"-":p.Direction.NONE,East:p.Direction.EAST,West:p.Direction.WEST,North:p.Direction.NORTH,South:p.Direction.SOUTH},m=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.handleChange=function(){var e=this.zoom&&this.zoom.checked,t=this.direction?+this.direction.value:void 0;this.props.onUpdate({tileType:e<<p.WallTypeShift|this.type.value,direction:t})},t.prototype.render=function(){var e=this,t=~p.WallTypeMask&this.props.cell.tileType_,n=p.WallTypeMask&this.props.cell.tileType_;return u.default.createElement("form",{className:"span4 offset1"},u.default.createElement("img",{src:d.default}),u.default.createElement("header",null,u.default.createElement("strong",null,"Editing Cell (",this.props.row,", ",this.props.col,")")),u.default.createElement("label",{htmlFor:"tileType"},"Tile Type (required):"),u.default.createElement("select",{ref:function(t){e.type=t},name:"tileType",value:t,onChange:this.handleChange},Object.entries(g).map(function(e){var t=s(e,2),n=t[0],r=t[1];return u.default.createElement("option",{value:r,key:r},n)})),t>65535&&u.default.createElement("span",null,u.default.createElement("label",{htmlFor:"zoom"},"Double size:"),u.default.createElement("input",{ref:function(t){e.zoom=t},name:"zoom",type:"checkbox",checked:n,onChange:this.handleChange})),t===p.SquareType.SPRITESTART&&u.default.createElement("span",null,u.default.createElement("label",{htmlFor:"direction"},"Start direction:"),u.default.createElement("select",{ref:function(t){e.direction=t},name:"direction",value:this.props.cell.direction_,onChange:this.handleChange},Object.entries(T).map(function(e){var t=s(e,2),n=t[0],r=t[1];return u.default.createElement("option",{value:r,key:r},n)}))))},t}(h.default);t.default=m,e.exports=t.default},3118:function(e,t,n){e.exports=n.p+"tile-guidewp3ebdf2cbc512efb380c5833cfc56b739.png"},3119:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(1551),p=r(u),c=n(2110),d=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.renderFields=function(t){return l.default.createElement("div",null,e.prototype.renderTileTypes.call(this,t,c.SquareType))},t}(p.default);t.default=d,e.exports=t.default},3120:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var s,l=n(1),u=function(e){return e&&e.__esModule?e:{default:e}}(l),p=n(1047),c=n(1203),d=(s={},a(s,p.SquareType.OPEN,"none"),a(s,p.SquareType.SPRITEFINISH,"goal"),a(s,p.SquareType.SPRITESTART,"sprite"),s),f=["dog","cat","penguin","dinosaur","octopus","witch","bat","bird","dragon","squirrel","wizard","alien","ghost","monster","robot","unicorn","zombie","knight","ninja","pirate","caveboy","cavegirl","princess","spacebot","soccergirl","soccerboy","tennisgirl","tennisboy"],h=["border","path","start","end","obstacle"],g=["","flower-or-hive","flower-or-nothing","hive-or-nothing","flower-hive-or-nothing"],T=["hive","flower"],m=function(e){function t(){return r(this,t),o(this,e.apply(this,arguments))}return i(t,e),t.prototype.render=function(){var e=this.props.cell,t=[],n={},r=void 0;if(this.props.selected&&t.push("selected"),this.props.highlighted&&t.push("highlighted"),"playlab"===this.props.skin)t.push("playlab",d[e.getTileType()]),e.getTileType()===p.SquareType.SPRITESTART&&void 0!==e.sprite_&&(n.backgroundImage="url('/blockly/media/skins/studio/"+f[e.sprite_]+"_spritesheet_200px.png')");else if("starwarsgrid"===this.props.skin)if(1===e.tileType_)n.backgroundImage="url('/blockly/media/skins/hoc2015x/goal.png')";else if(16===e.tileType_)n.backgroundImage="url('/blockly/media/skins/hoc2015x/instructions_bb8.png')",n.backgroundSize="cover";else{r=p.WallTypeMask&e.tileType_?"2x":"";var o=(p.WallCoordColMask&e.tileType_)>>p.WallCoordColShift,i=(p.WallCoordRowMask&e.tileType_)>>p.WallCoordRowShift;n.backgroundImage="url('/blockly/media/skins/hoc2015x/tiles_background1.png')",n.backgroundSize="800% 800%",n.backgroundPosition="-"+48*o+"px -"+38*i+"px"}else if("bounce"===this.props.skin){var a=["tiles_wall","goal","ball","paddle","paddle","ball","obstacle"];if(e.tileType_){var s=a[Math.log2(e.tileType_)];n.backgroundImage="url('/blockly/media/skins/bounce/"+s+".png')"}}else{if(t.push(h[e.tileType_]),c.utils.isBeeSkin(this.props.skin))e.isVariableCloud()?(t.push("conditional"),t.push(g[e.cloudType_])):void 0!==e.featureType_&&t.push(T[e.featureType_]);else if(e.isDirt()){t.push("dirt");var l=e.getCurrentValue(),m=10+l+(l<0?1:0);n.backgroundPosition=50*-m}void 0!==e.originalValue_&&null!==e.originalValue_&&(r=e.originalValue_.toString(),e.range_&&e.range_>e.originalValue_&&(r+=" - "+e.range_.toString()))}return u.default.createElement("td",{className:t.join(" "),onClick:this.props.onClick.bind(null,this.props.row,this.props.col),onMouseDown:this.props.onMouseDown.bind(null,this.props.row,this.props.col),onMouseOver:this.props.onMouseOver.bind(null,this.props.row,this.props.col),onMouseUp:this.props.onMouseUp.bind(null,this.props.row,this.props.col),style:n},r)},t}(u.default.Component);m.propTypes={cell:l.PropTypes.object.isRequired,row:l.PropTypes.number.isRequired,col:l.PropTypes.number.isRequired,selected:l.PropTypes.bool.isRequired,onClick:l.PropTypes.func.isRequired,onMouseDown:l.PropTypes.func.isRequired,onMouseOver:l.PropTypes.func.isRequired,onMouseUp:l.PropTypes.func.isRequired,skin:l.PropTypes.string.isRequired,highlighted:l.PropTypes.bool};var y=function(e){function t(){var n,i,a;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=o(this,e.call.apply(e,[this].concat(l))),i.state={},i.beginDrag=function(e,t){i.setState({dragging:!0,dragStart:{row:e,col:t}})},i.moveDrag=function(e,t){i.state.dragging&&i.setState({dragCurrent:{row:e,col:t}})},i.endDrag=function(e,t){var n=i.state.dragStart;if(i.setState({dragging:!1,dragStart:null,dragCurrent:null}),n&&(n.row!==e||n.col!==t)){var r=Math.min(n.row,e),o=Math.min(n.col,t),a=Math.max(n.row,e),s=Math.max(n.col,t),l=i.props.cells.slice(r,a+1).map(function(e){return e.slice(o,s+1).map(function(e){return e.serialize()})});i.props.setCopiedCells(l)}},a=n,o(i,a)}return i(t,e),t.prototype.isHighlighting=function(e,t){return!(!this.state.dragging||!this.state.dragCurrent)&&(e>=Math.min(this.state.dragStart.row,this.state.dragCurrent.row)&&e<=Math.max(this.state.dragStart.row,this.state.dragCurrent.row)&&t>=Math.min(this.state.dragStart.col,this.state.dragCurrent.col)&&t<=Math.max(this.state.dragStart.col,this.state.dragCurrent.col))},t.prototype.render=function(){var e=this,t=this.props.cells.map(function(t,n){var r=t.map(function(t,r){var o=e.props.selectedRow===n&&e.props.selectedCol===r;return u.default.createElement(m,{key:"cell-"+n+"-"+r,cell:t,row:n,col:r,selected:o,highlighted:e.isHighlighting(n,r),onClick:e.props.onSelectionChange,onMouseDown:e.beginDrag,onMouseOver:e.moveDrag,onMouseUp:e.endDrag,skin:e.props.skin})});return u.default.createElement("tr",{key:"row-"+n},r)});return u.default.createElement("table",null,u.default.createElement("tbody",null,t))},t}(u.default.Component);y.propTypes={cells:l.PropTypes.arrayOf(l.PropTypes.arrayOf(l.PropTypes.object)).isRequired,selectedRow:l.PropTypes.number,selectedCol:l.PropTypes.number,skin:l.PropTypes.string.isRequired,onSelectionChange:l.PropTypes.func.isRequired,setCopiedCells:l.PropTypes.func.isRequired},t.default=y,e.exports=t.default},3121:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(471),p=n(1298),c=r(p),d={button:{float:"left",marginRight:"5px"},attachment:{background:"#08c",color:"#fff",borderRadius:"4px",padding:"0 5px",margin:"4px 4px 4px 0",float:"left",fontSize:"0.8em"}},f=function(e){function t(){var n,r,a;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=i(this,e.call.apply(e,[this].concat(l))),r.state={loaded:!1},r.onAssetListReceived=function(e){c.default.reset(e.files),r.isMounted_&&r.setState({loaded:!0})},r.showAssetManager=function(){dashboard.assets.showAssetManager(null,"document",r.setState.bind(r,{loaded:!0}),{showUnderageWarning:r.props.showUnderageWarning})},a=n,i(r,a)}return a(t,e),t.prototype.componentWillMount=function(){u.assets.getFiles(this.onAssetListReceived)},t.prototype.componentDidMount=function(){this.isMounted_=!0},t.prototype.componentWillUnmount=function(){this.isMounted_=!1},t.prototype.render=function(){var e=l.default.createElement("span",{style:{fontSize:"0.8em"}},"Loading...");this.state.loaded&&(e=c.default.list().map(function(e){var t=u.assets.basePath(e.filename);return l.default.createElement("a",{key:e.filename,style:d.attachment,href:t,target:"_blank"},e.filename)}));var t=void 0;return this.props.readonly||(t=l.default.createElement("input",{style:d.button,className:"btn btn-default",type:"button",value:"Add/Remove Attachments",onClick:this.showAssetManager})),l.default.createElement("span",null,t,e)},t}(l.default.Component);f.propTypes={readonly:s.PropTypes.bool,showUnderageWarning:s.PropTypes.bool},t.default=f,window.dashboard=window.dashboard||{},window.dashboard.Attachments=f,e.exports=t.default},3122:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){var s=[[.7,"#00FF00"],[.5,"#b4ff00"],[.45,"#ccff00"],[.4,"#ffff00"],[.3,"#ffdf00"],[.2,"#ff8100"],[.15,"#ff9900"],[.1,"#ff0000"],[.05,"#a61c00"],[0,"#5b0f00"]];Handsontable.renderers.NumericRenderer.apply(this,arguments);for(var l=parseFloat(i),u=0;u<s.length;u++)if(l>=s[u][0])return void(t.style.background=s[u][1])}function o(e,t,n,r,o,i,a){var s=[[.98,"#00FF00"],[.95,"#94ff20"],[.92,"#b5ff04"],[.9,"#d7ff00"],[.85,"#efff00"],[.82,"#ffdf00"],[.8,"#ff9900"],[.75,"#ff6900"],[.7,"#ff3a00"],[0,"#ff0000"]];Handsontable.renderers.NumericRenderer.apply(this,arguments);for(var l=parseFloat(i),u=0;u<s.length;u++)if(l>=s[u][0])return void(t.style.background=s[u][1])}function i(e,t,n,r,o,i,a){var s=0;if(i){var l=parseFloat(i),u=Math.floor(l/60),p=l-60*u;i=("0"+u).substr(-2)+":"+("0"+p).substr(-2),s=Math.min(1,l/600)}Handsontable.renderers.TextRenderer.apply(this,arguments),t.style["font-family"]="monospace",t.style.background="linear-gradient(90deg, silver "+100*s+"%, white 0%)"}var a=n(34),s=function(e){return e&&e.__esModule?e:{default:e}}(a);t.hideAndShowDomElements=function(e,t){e&&(0,s.default)("#samplingMessage").show(),t&&(0,s.default)("#completionTable").show()},t.populateTable=function(e,t){(0,s.default)("#completionTable").handsontable({data:t,startRows:10,startCols:9,colHeaders:e,colWidths:[200,100,100,100,100,100,100,100,100,100],stretchH:"none",columnSorting:!0,manualColumnResize:!0,columns:[{data:"Puzzle"},{data:"TotalAttempt",type:"numeric"},{data:"TotalSuccess",type:"numeric"},{data:"Avg Success Rate",type:"numeric",format:"0.00%"},{data:"Avg attempts per completion",type:"numeric",format:"0.00"},{data:"UniqueAttempt",type:"numeric"},{data:"UniqueSuccess",type:"numeric"},{data:"Perceived Dropout",type:"numeric"},{data:"Avg Unique Success Rate",type:"numeric",format:"0.00%"},{data:"timeOnSite"}],cells:function(e,t,n){return 3===t?{renderer:r}:8===t?{renderer:o}:9===t?{renderer:i}:{}}})}},3123:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(34),i=r(o),a=n(1),s=r(a),l=n(39),u=r(l),p=n(3124),c=r(p);t.default={init:function(e,t,n){function r(){if(!o){var t=document.createElement("div");t.id="pairing",document.body.appendChild(t),o=u.default.render(s.default.createElement(c.default,{source:e}),t)}o.open()}var o=void 0;n&&r(),(0,i.default)("#pairing_link").show().click(function(){return r(),t(),!1})}},e.exports=t.default},3124:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=n(3125),p=r(u),c=n(220),d=r(c),f=function(e){function t(){var n,r,a;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=i(this,e.call.apply(e,[this].concat(l))),r.state={isOpen:!1},r.close=function(){return r.setState({isOpen:!1})},r.open=function(){return r.setState({isOpen:!0})},a=n,i(r,a)}return a(t,e),t.prototype.render=function(){return l.default.createElement(d.default,{isOpen:this.state.isOpen,handleClose:this.close},l.default.createElement(p.default,{source:this.props.source,handleClose:this.close}))},t}(l.default.Component);f.propTypes={source:s.PropTypes.string},t.default=f,e.exports=t.default},3125:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(34),l=r(s),u=n(1),p=r(u),c=n(3126),d=r(c),f=n(3127),h=r(f),g=function(e){function t(){var n,r,a;o(this,t);for(var s=arguments.length,u=Array(s),p=0;p<s;p++)u[p]=arguments[p];return n=r=i(this,e.call.apply(e,[this].concat(u))),r.state={pairings:[],sections:[]},r.handleSectionChange=function(e){r.setState({pairings:[],sections:r.state.sections,selectedSectionId:+e.target.value})},r.refreshUserMenu=function(){l.default.ajax({type:"GET",url:"/dashboardapi/user_menu",success:function(e){return(0,l.default)("#sign_in_or_user").html(e)}})},r.handleAddPartners=function(e){var t=r.selectedSection().students.filter(function(t){return-1!==e.indexOf(t.id)});r.props.handleClose&&r.props.handleClose(),l.default.ajax({url:r.props.source,data:JSON.stringify({pairings:t}),contentType:"application/json; charset=utf-8",method:"PUT",dataType:"json",context:r}).done(r.refreshUserMenu).fail(function(e,t,n){})},r.handleStop=function(e){r.setState({pairings:[]}),l.default.ajax({url:r.props.source,data:JSON.stringify({pairings:[]}),contentType:"application/json; charset=utf-8",method:"PUT",dataType:"json"}).done(function(){r.refreshUserMenu(),r.props.handleClose()}).fail(function(e,t,n){}),e.preventDefault()},a=n,i(r,a)}return a(t,e),t.prototype.componentWillMount=function(){var e=this;l.default.ajax({url:this.props.source,method:"GET",dataType:"json"}).done(function(t){e.setState({pairings:t.pairings,sections:t.sections})}).fail(function(e){})},t.prototype.selectedSectionId=function(){return 1===this.state.sections.length?+this.state.sections[0].id:this.state.selectedSectionId},t.prototype.selectedSection=function(){var e=this.selectedSectionId();return e?this.state.sections.find(function(t){return t.id===e})||null:null},t.prototype.studentsInSection=function(){var e=this.selectedSection();return e?e.students:null},t.prototype.renderPairingSelector=function(){return p.default.createElement("div",{style:{maxHeight:.8*window.innerHeight-100,overflowY:"auto"}},p.default.createElement("p",{className:"dialog_title"},"Pair programming"),p.default.createElement("h1",null,"Choose partners:"),p.default.createElement("br",null),p.default.createElement("form",null,p.default.createElement(d.default,{sections:this.state.sections,selectedSectionId:this.selectedSectionId(),handleChange:this.handleSectionChange}),p.default.createElement("div",{className:"clear"}),p.default.createElement(h.default,{students:this.studentsInSection(),handleSubmit:this.handleAddPartners})))},t.prototype.renderPairingState=function(){return p.default.createElement("div",null,p.default.createElement("h1",null,"Pair Programming"),p.default.createElement("h2",null,"You are Pair Programming with:"),this.state.pairings.map(function(e){return p.default.createElement("div",{key:e.id,"data-id":e.id,className:"student"},e.name)}),p.default.createElement("div",{className:"clear"}),p.default.createElement("button",{className:"stop",onClick:this.handleStop},"Stop Pair Programming"),p.default.createElement("button",{className:"ok",onClick:this.props.handleClose},"OK"))},t.prototype.render=function(){return 0===this.state.pairings.length?this.renderPairingSelector():this.renderPairingState()},t}(p.default.Component);g.propTypes={source:u.PropTypes.string,handleClose:u.PropTypes.func},t.default=g,e.exports=t.default},3126:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=n(2407),u=function(e){function t(){return r(this,t),o(this,e.apply(this,arguments))}return i(t,e),t.prototype.render=function(){return 0===this.props.sections.length||1===this.props.sections.length?null:s.default.createElement("select",{name:"sectionId",value:this.props.selectedSectionId,onChange:this.props.handleChange},s.default.createElement("option",{key:"blank",value:""},"Choose your section"),this.props.sections.map(function(e){return s.default.createElement("option",{key:e.id,value:e.id},e.name)}))},t}(s.default.Component);u.propTypes={sections:a.PropTypes.arrayOf(a.PropTypes.shape({id:a.PropTypes.number,name:a.PropTypes.string,students:l.studentsShape})),selectedSectionId:a.PropTypes.number,handleChange:a.PropTypes.func.isRequired},t.default=u,e.exports=t.default},3127:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(2407),p=function(e){function t(){var n,a,s;o(this,t);for(var l=arguments.length,u=Array(l),p=0;p<l;p++)u[p]=arguments[p];return n=a=i(this,e.call.apply(e,[this].concat(u))),a.state={selectedStudentIds:[]},a.handleStudentClicked=function(e){var t=[].concat(r(a.state.selectedStudentIds)),n=+e.target.getAttribute("data-id"),o=t.indexOf(n);-1===o?t.push(n):t.splice(o,1),a.setState({selectedStudentIds:t})},a.handleSubmit=function(e){a.props.handleSubmit(a.state.selectedStudentIds),e.preventDefault()},s=n,i(a,s)}return a(t,e),t.prototype.render=function(){var e=this;if(!this.props.students)return null;if(0===this.props.students.length)return l.default.createElement("span",null,"There are no other students in this section.");var t=this.props.students.map(function(t){var n="student selectable";return-1!==e.state.selectedStudentIds.indexOf(t.id)&&(n="student selectable selected"),l.default.createElement("div",{key:t.id,"data-id":t.id,className:n,onClick:e.handleStudentClicked},t.name)});return l.default.createElement("div",null,t,l.default.createElement("div",{className:"clear"}),0!==this.state.selectedStudentIds.length&&l.default.createElement("button",{onClick:this.handleSubmit,className:"addPartners"},"Add Partners"))},t}(l.default.Component);p.propTypes={students:u.studentsShape,handleSubmit:s.PropTypes.func.isRequired},t.default=p,e.exports=t.default},3128:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(34),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(156),s=n(818),l=n(666),u=function(){function e(t){r(this,e),this.levelId=t,(0,i.default)(document).ready(function(){var e=(0,i.default)("textarea#level_"+t+".response");if(!e.val()){var n=(0,l.sourceForLevel)(window.appOptions.scriptName,t);n&&e.val(n)}e.blur(function(){(0,s.onAnswerChanged)(t,!0)}),e.on("input",null,null,function(){(0,s.onAnswerChanged)(t,!1)})})}return e.prototype.getResult=function(){var e=(0,i.default)("#level_"+this.levelId).val();return{response:e,valid:e.length>0,result:!0,testResult:a.TestResults.FREE_PLAY}},e.prototype.getAppName=function(){return"free_response"},e.prototype.lockAnswers=function(){(0,i.default)("textarea#level_"+this.levelId+".response").prop("disabled",!0)},e.prototype.getCurrentAnswerFeedback=function(){},e}();t.default=u,e.exports=t.default},34:function(e,t){e.exports=$},3663:function(e,t,n){n(210),n(211),e.exports=n(3107)}},[3663]);
